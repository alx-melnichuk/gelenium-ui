import { isPlatformBrowser } from '@angular/common';
import { ChangeDetectionStrategy, Component, EventEmitter, forwardRef, Inject, InjectionToken, Input, Optional, Output, PLATFORM_ID, ViewChild, ViewEncapsulation, } from '@angular/core';
import { FormControl, FormGroup, NG_VALIDATORS, NG_VALUE_ACCESSOR, Validators, } from '@angular/forms';
import { GLN_NODE_INTERNAL_VALIDATOR } from '../directives/gln-regex/gln-node-internal-validator.interface';
import { GlnBasisFrame } from '../_classes/gln-basis-frame.class';
import { GlnFrameSize, GlnFrameSizeUtil } from '../gln-frame/gln-frame-size.interface';
import { HtmlElemUtil } from '../_utils/html-elem.util';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/forms";
import * as i3 from "../directives/gln-frame-exterior-input/gln-frame-exterior-input.directive";
import * as i4 from "../gln-frame/gln-frame.component";
import * as i5 from "../directives/gln-frame-ornament/gln-frame-ornament.directive";
import * as i6 from "../directives/gln-frame-size/gln-frame-size.directive";
import * as i7 from "../gln-hint-or-error/gln-hint-or-error.component";
let uniqueIdCounter = 0;
export const GLN_TEXTAREA_CONFIG = new InjectionToken('GLN_TEXTAREA_CONFIG');
export class GlnTextareaComponent extends GlnBasisFrame {
    // public isWriteValueInit: boolean | null = null;                            // Is in GlnBasisControl.
    // public labelShrink: boolean | null = null; // Binding attribute "isLabelShrink". // Is in GlnBasisControl.
    // public noAnimation: boolean | null = null; // Binding attribute "isNoAnimation". // Is in GlnBasisControl.
    // public noLabel: boolean | null = null; // Binding attribute "isNoLabel". // Is in GlnBasisControl.
    // public readOnly: boolean | null = null; // Binding attribute "isReadOnly". // Is in GlnBasisControl.
    // public required: boolean | null = null; // Binding attribute "isRequired". // Is in GlnBasisControl.
    // public valueInit: boolean | null = null; // Binding attribute "isValueInit". // Is in GlnBasisControl.
    constructor(
    // eslint-disable-next-line @typescript-eslint/ban-types
    platformId, changeDetectorRef, rootConfig, hostRef, renderer, ngZone) {
        super(uniqueIdCounter++, 'glntx', hostRef, renderer, changeDetectorRef, ngZone);
        this.platformId = platformId;
        this.rootConfig = rootConfig;
        // @Input()
        // public id = `glntx-${uniqueIdCounter++}`; // Is in GlnBasisControl.
        this.autoComplete = '';
        this.tabIndex = 0;
        this.focused = new EventEmitter();
        this.blured = new EventEmitter();
        // @Output()
        // readonly writeValueInit: EventEmitter<() => void> = new EventEmitter(); // From GlnBasisByFrame
        this.textareaElementRef = null;
        this.currConfig = null;
        this.currentRows = 1;
        // public disabled: boolean | null = null; // Binding attribute "isDisabled". // Is in GlnBasisControl.
        // public error: boolean | null = null; // Binding attribute "isError". // Is in GlnBasisControl.
        this.formControl = new FormControl({ value: null, disabled: false }, []);
        this.formGroup = new FormGroup({ textData: this.formControl });
        this.frameSizeDefault = GlnFrameSizeUtil.getValue(GlnFrameSize.middle) || 0;
        this.isFocused = false;
        this.isFilled = false;
        this.currConfig = this.rootConfig;
        HtmlElemUtil.setClass(this.renderer, this.hostRef, 'gln-textarea', true);
        HtmlElemUtil.setClass(this.renderer, this.hostRef, 'gln-control', true);
    }
    ngOnChanges(changes) {
        // In the GlnBasisControl.ngOnChanges(), the definition is made:
        // - this.disabled = BooleanUtil.init(this.isDisabled);
        // - this.error = BooleanUtil.init(this.isError);
        // - this.labelShrink = BooleanUtil.init(this.isLabelShrink);
        // - this.noAnimation = BooleanUtil.init(this.isNoAnimation);
        // - this.noLabel = BooleanUtil.init(this.isNoLabel);
        // - this.readOnly = BooleanUtil.init(this.isReadOnly);
        // - this.required = BooleanUtil.init(this.isRequired);
        // - this.valueInit = BooleanUtil.init(this.isValueInit);
        super.ngOnChanges(changes);
        if (changes['config']) {
            this.currConfig = { ...this.rootConfig, ...this.config };
        }
        if (changes['isRequired'] || changes['minLength'] || changes['maxLength']) {
            this.prepareFormGroup(this.required, this.minLength || null, this.maxLength || null);
        }
        if (changes['cntRows'] || changes['minRows'] || changes['maxRows']) {
            this.currentRows = this.cntRows || this.getCurrentRows(this.getNumberLines(this.formControl.value), this.minRows, this.maxRows);
        }
    }
    ngOnInit() {
        super.ngOnInit();
    }
    ngAfterContentInit() {
        super.ngAfterContentInit();
    }
    // ** ControlValueAccessor - start **
    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any
    writeValue(value) {
        const isFilledOld = !!this.formControl.value;
        const cntLinesOld = this.getNumberLines(this.formControl.value);
        this.formControl.setValue(value, { emitEvent: false });
        this.isFilled = this.formControl.value !== '' && this.formControl.value != null;
        const cntLines = this.getNumberLines(this.formControl.value);
        if (cntLinesOld != cntLines) {
            this.currentRows = this.cntRows || this.getCurrentRows(this.getNumberLines(this.formControl.value), this.minRows, this.maxRows);
        }
        if (isFilledOld !== this.isFilled || cntLinesOld != cntLines) {
            this.changeDetectorRef.markForCheck();
        }
        super.writeValue(value);
    }
    setDisabledState(isDisabled) {
        if (this.disabled !== isDisabled) {
            isDisabled ? this.formGroup.disable() : this.formGroup.enable();
            super.setDisabledState(isDisabled);
        }
    }
    // ** ControlValueAccessor - finish **
    // ** Validator - start **
    validate(control) {
        return !control ? null : this.formControl.errors;
    }
    // ** Validator - finish **
    // ** GlnNodeInternalValidator - start **
    addValidators(validators) {
        if (validators != null) {
            this.formControl.addValidators(validators);
            this.formControl.updateValueAndValidity();
        }
    }
    addAsyncValidators(validators) {
        if (validators != null) {
            this.formControl.addAsyncValidators(validators);
            this.formControl.updateValueAndValidity();
        }
    }
    // ** GlnNodeInternalValidator - finish **
    // ** Public API **
    focus() {
        if (isPlatformBrowser(this.platformId) && !!this.textareaElementRef) {
            this.textareaElementRef.nativeElement.focus();
        }
    }
    doFocus() {
        this.isFocused = true;
        this.focusState(this.renderer, this.hostRef, this.isFocused);
        this.focused.emit();
    }
    doBlur() {
        this.isFocused = false;
        this.focusState(this.renderer, this.hostRef, this.isFocused);
        this.isFilled = !!this.formControl.value;
        this.onTouched();
        this.blured.emit();
    }
    doInput(event) {
        // https://github.com/angular/angular/issues/9587 "event.stopImmediatePropagation() called from listeners not working"
        // Added Event.cancelBubble check to make sure there was no call to event.stopImmediatePropagation() in previous handlers.
        if (!!event && !event.cancelBubble) {
            this.onChange(this.formControl.value);
            this.currentRows = this.cntRows || this.getCurrentRows(this.getNumberLines(this.formControl.value), this.minRows, this.maxRows);
        }
    }
    // ** Private API **
    prepareFormGroup(isRequired, minLength, maxLength) {
        this.formControl.clearValidators();
        const newValidator = [];
        if (isRequired) {
            newValidator.push(Validators.required);
        }
        if (!!minLength && minLength > 0) {
            newValidator.push(Validators.minLength(minLength));
        }
        if (!!maxLength && maxLength > 0) {
            newValidator.push(Validators.maxLength(maxLength));
        }
        this.formControl.setValidators(newValidator);
    }
    focusState(renderer, elem, value) {
        HtmlElemUtil.setClass(renderer, elem, 'gln-focused', value || false);
        HtmlElemUtil.setAttr(renderer, elem, 'foc', value ? '' : null);
    }
    getCurrentRows(numberOfLines, minRows, maxRows) {
        let result = numberOfLines > 0 ? numberOfLines : 1;
        if (!!minRows && minRows > 0 && minRows > result) {
            result = minRows;
        }
        if (!!maxRows && maxRows > 0 && result > maxRows) {
            result = maxRows;
        }
        return result;
    }
    getNumberLines(value) {
        return (value || '').split('\n').length;
    }
}
GlnTextareaComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.1.2", ngImport: i0, type: GlnTextareaComponent, deps: [{ token: PLATFORM_ID }, { token: i0.ChangeDetectorRef }, { token: GLN_TEXTAREA_CONFIG, optional: true }, { token: i0.ElementRef }, { token: i0.Renderer2 }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component });
GlnTextareaComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.1.2", type: GlnTextareaComponent, selector: "gln-textarea", inputs: { autoComplete: "autoComplete", cntCols: "cntCols", cntRows: "cntRows", config: "config", exterior: "exterior", frameSize: "frameSize", helperText: "helperText", label: "label", maxLength: "maxLength", maxRows: "maxRows", minLength: "minLength", minRows: "minRows", ornamLfAlign: "ornamLfAlign", ornamRgAlign: "ornamRgAlign", tabIndex: "tabIndex", wdFull: "wdFull" }, outputs: { focused: "focused", blured: "blured" }, providers: [
        { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() => GlnTextareaComponent), multi: true },
        { provide: NG_VALIDATORS, useExisting: forwardRef(() => GlnTextareaComponent), multi: true },
        { provide: GLN_NODE_INTERNAL_VALIDATOR, useExisting: GlnTextareaComponent },
    ], viewQueries: [{ propertyName: "textareaElementRef", first: true, predicate: ["textareaElement"], descendants: true }], exportAs: ["glnTextarea"], usesInheritance: true, usesOnChanges: true, ngImport: i0, template: "<ng-container [formGroup]=\"formGroup\">\n  <div class=\"glntx-wrap\"\n    [glnFrameExteriorInput]=\"exterior || currConfig?.exterior\"\n    #glnFrameExteriorInput=\"glnFrameExteriorInput\"\n    [glnFrameExteriorInputElementRef]=\"hostRef\"\n    (glnFrameExteriorInputChange)=\"glnFrameSize.updatePaddingVerAndHor()\">\n    <gln-frame [config]=\"config\"\n      [exterior]=\"glnFrameExteriorInput.exterior\"\n      [isDisabled]=\"disabled\"\n      [isError]=\"!!formControl.errors || error\"\n      [isFilled]=\"isFilled\"\n      [isLabelShrink]=\"labelShrink || currConfig?.isLabelShrink\"\n      [isNoAnimation]=\"noAnimation || currConfig?.isNoAnimation || isWriteValueInit\"\n      [isNoLabel]=\"noLabel || currConfig?.isNoLabel\"\n      [isRequired]=\"required\"\n      [label]=\"label\"\n      [glnFrameSize]=\"frameSize || currConfig?.frameSize\"\n      #glnFrameSize=\"glnFrameSize\"\n      [glnFrameSizeElementRef]=\"hostRef\"\n      [glnFrameSizeValue]=\"currConfig?.frameSizeValue || frameSizeDefault\"\n      [glnFrameSizeLabelPd]=\"currConfig?.labelPd\"\n      [glnFrameSizePrepare]=\"glnFrameExteriorInput\"\n      glnFrameOrnament\n      [glnFrameOrnamentLfAlign]=\"ornamLfAlign || currConfig?.ornamLfAlign\"\n      [glnFrameOrnamentRgAlign]=\"ornamRgAlign || currConfig?.ornamRgAlign\"\n      [glnFrameOrnamentPath]=\"'/div{0}'\">\n\n      <span glnfr-orn-lf\n        class=\"gln-ornam-lf\">\n        <ng-content select=\"[gln-orn-lf]\"></ng-content>\n      </span>\n      <span glnfr-orn-rg\n        class=\"gln-ornam-rg\">\n        <ng-content select=\"[gln-orn-rg]\"></ng-content>\n      </span>\n\n      <textarea #textareaElement\n        formControlName=\"textData\"\n        glnfr-mr-ver\n        glnfr-pd-hor\n        glnfr-elem\n        [attr.id]=\"id + '_textarea'\"\n        [rows]=\"currentRows\"\n        [ngClass]=\"['glntx-textarea', (readOnly ? 'gln-readonly' : '')]\"\n        [attr.disabled]=\"disabled ? '': null\"\n        [attr.autocomplete]=\"!!autoComplete ? autoComplete : null\"\n        [attr.readonly]=\"readOnly ? '': null\"\n        [attr.tabindex]=\"!disabled ? tabIndex : null\"\n        [cols]=\"cntCols\"\n        (focus)=\"doFocus()\"\n        (blur)=\"doBlur()\"\n        (input)=\"doInput($event)\"\n        (click)=\"$event.stopPropagation();\">\n      </textarea>\n\n    </gln-frame>\n  </div>\n</ng-container>\n<gln-hint-or-error *ngIf=\"!!helperText\"\n  [text]=\"helperText\"\n  [isError]=\"!!formControl.errors || error\"\n  [isFocused]=\"isFocused\"\n  [isDisabled]=\"disabled\">\n</gln-hint-or-error>", styles: ["gln-textarea{display:inline-flex;flex-direction:column}gln-textarea[wdFull]{width:100%}gln-textarea[wdFull] gln-frame>div>[glnfr-elem]{width:100%}gln-textarea[noHeEllipsis] gln-hint-or-error{white-space:normal;overflow:visible;text-overflow:clip}gln-textarea .glntx-textarea{font-size:inherit;font-family:inherit;letter-spacing:inherit;color:inherit;border:0;box-sizing:content-box;background:none;margin:0;padding:0;resize:none}gln-textarea .glntx-textarea:focus{outline:0}gln-textarea gln-hint-or-error{padding-left:var(--glntx-he-pd-lf, var(--glnfrs-pd-lf));padding-right:var(--glntx-he-pd-rg, var(--glnfrs-pd-rg))}\n"], dependencies: [{ kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i2.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i2.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i2.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "directive", type: i3.GlnFrameExteriorInputDirective, selector: "[glnFrameExteriorInput]", inputs: ["glnFrameExteriorInput", "glnFrameExteriorInputElementRef"], outputs: ["glnFrameExteriorInputChange"], exportAs: ["glnFrameExteriorInput"] }, { kind: "component", type: i4.GlnFrameComponent, selector: "gln-frame", inputs: ["config", "exterior", "isDisabled", "isError", "isFilled", "isLabelShrink", "isNoAnimation", "isNoLabel", "isRequired", "label"], exportAs: ["glnFrame"] }, { kind: "directive", type: i5.GlnFrameOrnamentDirective, selector: "[glnFrameOrnament]", inputs: ["glnFrameOrnamentLfAlign", "glnFrameOrnamentRgAlign", "glnFrameOrnamentElementRef", "glnFrameOrnamentPath", "glnFrameOrnamentAfterContent"], exportAs: ["glnFrameOrnament"] }, { kind: "directive", type: i6.GlnFrameSizeDirective, selector: "[glnFrameSize]", inputs: ["glnFrameSize", "glnFrameSizeValue", "glnFrameSizeLabelPd", "glnFrameSizeElementRef", "glnFrameSizePrepare", "glnFrameSizeModify"], outputs: ["glnFrameSizeChange"], exportAs: ["glnFrameSize"] }, { kind: "component", type: i7.GlnHintOrErrorComponent, selector: "gln-hint-or-error", inputs: ["text", "isError", "isFocused", "isDisabled"], exportAs: ["glnHintOrError"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.1.2", ngImport: i0, type: GlnTextareaComponent, decorators: [{
            type: Component,
            args: [{ selector: 'gln-textarea', exportAs: 'glnTextarea', encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, providers: [
                        { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() => GlnTextareaComponent), multi: true },
                        { provide: NG_VALIDATORS, useExisting: forwardRef(() => GlnTextareaComponent), multi: true },
                        { provide: GLN_NODE_INTERNAL_VALIDATOR, useExisting: GlnTextareaComponent },
                    ], template: "<ng-container [formGroup]=\"formGroup\">\n  <div class=\"glntx-wrap\"\n    [glnFrameExteriorInput]=\"exterior || currConfig?.exterior\"\n    #glnFrameExteriorInput=\"glnFrameExteriorInput\"\n    [glnFrameExteriorInputElementRef]=\"hostRef\"\n    (glnFrameExteriorInputChange)=\"glnFrameSize.updatePaddingVerAndHor()\">\n    <gln-frame [config]=\"config\"\n      [exterior]=\"glnFrameExteriorInput.exterior\"\n      [isDisabled]=\"disabled\"\n      [isError]=\"!!formControl.errors || error\"\n      [isFilled]=\"isFilled\"\n      [isLabelShrink]=\"labelShrink || currConfig?.isLabelShrink\"\n      [isNoAnimation]=\"noAnimation || currConfig?.isNoAnimation || isWriteValueInit\"\n      [isNoLabel]=\"noLabel || currConfig?.isNoLabel\"\n      [isRequired]=\"required\"\n      [label]=\"label\"\n      [glnFrameSize]=\"frameSize || currConfig?.frameSize\"\n      #glnFrameSize=\"glnFrameSize\"\n      [glnFrameSizeElementRef]=\"hostRef\"\n      [glnFrameSizeValue]=\"currConfig?.frameSizeValue || frameSizeDefault\"\n      [glnFrameSizeLabelPd]=\"currConfig?.labelPd\"\n      [glnFrameSizePrepare]=\"glnFrameExteriorInput\"\n      glnFrameOrnament\n      [glnFrameOrnamentLfAlign]=\"ornamLfAlign || currConfig?.ornamLfAlign\"\n      [glnFrameOrnamentRgAlign]=\"ornamRgAlign || currConfig?.ornamRgAlign\"\n      [glnFrameOrnamentPath]=\"'/div{0}'\">\n\n      <span glnfr-orn-lf\n        class=\"gln-ornam-lf\">\n        <ng-content select=\"[gln-orn-lf]\"></ng-content>\n      </span>\n      <span glnfr-orn-rg\n        class=\"gln-ornam-rg\">\n        <ng-content select=\"[gln-orn-rg]\"></ng-content>\n      </span>\n\n      <textarea #textareaElement\n        formControlName=\"textData\"\n        glnfr-mr-ver\n        glnfr-pd-hor\n        glnfr-elem\n        [attr.id]=\"id + '_textarea'\"\n        [rows]=\"currentRows\"\n        [ngClass]=\"['glntx-textarea', (readOnly ? 'gln-readonly' : '')]\"\n        [attr.disabled]=\"disabled ? '': null\"\n        [attr.autocomplete]=\"!!autoComplete ? autoComplete : null\"\n        [attr.readonly]=\"readOnly ? '': null\"\n        [attr.tabindex]=\"!disabled ? tabIndex : null\"\n        [cols]=\"cntCols\"\n        (focus)=\"doFocus()\"\n        (blur)=\"doBlur()\"\n        (input)=\"doInput($event)\"\n        (click)=\"$event.stopPropagation();\">\n      </textarea>\n\n    </gln-frame>\n  </div>\n</ng-container>\n<gln-hint-or-error *ngIf=\"!!helperText\"\n  [text]=\"helperText\"\n  [isError]=\"!!formControl.errors || error\"\n  [isFocused]=\"isFocused\"\n  [isDisabled]=\"disabled\">\n</gln-hint-or-error>", styles: ["gln-textarea{display:inline-flex;flex-direction:column}gln-textarea[wdFull]{width:100%}gln-textarea[wdFull] gln-frame>div>[glnfr-elem]{width:100%}gln-textarea[noHeEllipsis] gln-hint-or-error{white-space:normal;overflow:visible;text-overflow:clip}gln-textarea .glntx-textarea{font-size:inherit;font-family:inherit;letter-spacing:inherit;color:inherit;border:0;box-sizing:content-box;background:none;margin:0;padding:0;resize:none}gln-textarea .glntx-textarea:focus{outline:0}gln-textarea gln-hint-or-error{padding-left:var(--glntx-he-pd-lf, var(--glnfrs-pd-lf));padding-right:var(--glntx-he-pd-rg, var(--glnfrs-pd-rg))}\n"] }]
        }], ctorParameters: function () { return [{ type: Object, decorators: [{
                    type: Inject,
                    args: [PLATFORM_ID]
                }] }, { type: i0.ChangeDetectorRef }, { type: undefined, decorators: [{
                    type: Optional
                }, {
                    type: Inject,
                    args: [GLN_TEXTAREA_CONFIG]
                }] }, { type: i0.ElementRef }, { type: i0.Renderer2 }, { type: i0.NgZone }]; }, propDecorators: { autoComplete: [{
                type: Input
            }], cntCols: [{
                type: Input
            }], cntRows: [{
                type: Input
            }], config: [{
                type: Input
            }], exterior: [{
                type: Input
            }], frameSize: [{
                type: Input
            }], helperText: [{
                type: Input
            }], label: [{
                type: Input
            }], maxLength: [{
                type: Input
            }], maxRows: [{
                type: Input
            }], minLength: [{
                type: Input
            }], minRows: [{
                type: Input
            }], ornamLfAlign: [{
                type: Input
            }], ornamRgAlign: [{
                type: Input
            }], tabIndex: [{
                type: Input
            }], wdFull: [{
                type: Input
            }], focused: [{
                type: Output
            }], blured: [{
                type: Output
            }], textareaElementRef: [{
                type: ViewChild,
                args: ['textareaElement']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xuLXRleHRhcmVhLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2dlbGVuaXVtLXVpL3NyYy9saWIvZ2xuLXRleHRhcmVhL2dsbi10ZXh0YXJlYS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9nZWxlbml1bS11aS9zcmMvbGliL2dsbi10ZXh0YXJlYS9nbG4tdGV4dGFyZWEuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDcEQsT0FBTyxFQUVMLHVCQUF1QixFQUV2QixTQUFTLEVBRVQsWUFBWSxFQUNaLFVBQVUsRUFDVixNQUFNLEVBQ04sY0FBYyxFQUNkLEtBQUssRUFJTCxRQUFRLEVBQ1IsTUFBTSxFQUNOLFdBQVcsRUFHWCxTQUFTLEVBQ1QsaUJBQWlCLEdBQ2xCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFJTCxXQUFXLEVBQ1gsU0FBUyxFQUNULGFBQWEsRUFDYixpQkFBaUIsRUFJakIsVUFBVSxHQUNYLE1BQU0sZ0JBQWdCLENBQUM7QUFFeEIsT0FBTyxFQUE0QiwyQkFBMkIsRUFBRSxNQUFNLCtEQUErRCxDQUFDO0FBQ3RJLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUVsRSxPQUFPLEVBQUUsWUFBWSxFQUFFLGdCQUFnQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDdkYsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDBCQUEwQixDQUFDOzs7Ozs7Ozs7QUFFeEQsSUFBSSxlQUFlLEdBQUcsQ0FBQyxDQUFDO0FBRXhCLE1BQU0sQ0FBQyxNQUFNLG1CQUFtQixHQUFHLElBQUksY0FBYyxDQUFpQixxQkFBcUIsQ0FBQyxDQUFDO0FBZTdGLE1BQU0sT0FBTyxvQkFDWCxTQUFRLGFBQWE7SUF5RXJCLHVHQUF1RztJQUN2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S0FBSyxFQUFFLElBQUksRUFBRTt3QkFDaEcsRUFBRSxPQUFPLEVBQUUsYUFBYSxFQUFFLFdBQVcsRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFFLHFCQUFxQixDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRTt3QkFDNUYsRUFBRSxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsV0FBVyxzQkFBc0IsRUFBRTtxQkFDNUU7MERBc0YwQyxNQUFNOzBCQUE5QyxNQUFNOzJCQUFDLFdBQVc7OzBCQUVsQixRQUFROzswQkFBSSxNQUFNOzJCQUFDLG1CQUFtQjtrSEEvRWxDLFlBQVk7c0JBRGxCLEtBQUs7Z0JBR0MsT0FBTztzQkFEYixLQUFLO2dCQUdDLE9BQU87c0JBRGIsS0FBSztnQkFHQyxNQUFNO3NCQURaLEtBQUs7Z0JBR0MsUUFBUTtzQkFEZCxLQUFLO2dCQUdDLFNBQVM7c0JBRGYsS0FBSztnQkFHQyxVQUFVO3NCQURoQixLQUFLO2dCQW1CQyxLQUFLO3NCQURYLEtBQUs7Z0JBR0MsU0FBUztzQkFEZixLQUFLO2dCQUdDLE9BQU87c0JBRGIsS0FBSztnQkFHQyxTQUFTO3NCQURmLEtBQUs7Z0JBR0MsT0FBTztzQkFEYixLQUFLO2dCQUdDLFlBQVk7c0JBRGxCLEtBQUs7Z0JBR0MsWUFBWTtzQkFEbEIsS0FBSztnQkFHQyxRQUFRO3NCQURkLEtBQUs7Z0JBR0MsTUFBTTtzQkFEWixLQUFLO2dCQUlHLE9BQU87c0JBRGYsTUFBTTtnQkFHRSxNQUFNO3NCQURkLE1BQU07Z0JBTUEsa0JBQWtCO3NCQUR4QixTQUFTO3VCQUFDLGlCQUFpQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7XG4gIEFmdGVyQ29udGVudEluaXQsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIGZvcndhcmRSZWYsXG4gIEluamVjdCxcbiAgSW5qZWN0aW9uVG9rZW4sXG4gIElucHV0LFxuICBOZ1pvbmUsXG4gIE9uQ2hhbmdlcyxcbiAgT25Jbml0LFxuICBPcHRpb25hbCxcbiAgT3V0cHV0LFxuICBQTEFURk9STV9JRCxcbiAgUmVuZGVyZXIyLFxuICBTaW1wbGVDaGFuZ2VzLFxuICBWaWV3Q2hpbGQsXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEFic3RyYWN0Q29udHJvbCxcbiAgQXN5bmNWYWxpZGF0b3JGbixcbiAgQ29udHJvbFZhbHVlQWNjZXNzb3IsXG4gIEZvcm1Db250cm9sLFxuICBGb3JtR3JvdXAsXG4gIE5HX1ZBTElEQVRPUlMsXG4gIE5HX1ZBTFVFX0FDQ0VTU09SLFxuICBWYWxpZGF0aW9uRXJyb3JzLFxuICBWYWxpZGF0b3IsXG4gIFZhbGlkYXRvckZuLFxuICBWYWxpZGF0b3JzLFxufSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbmltcG9ydCB7IEdsbk5vZGVJbnRlcm5hbFZhbGlkYXRvciwgR0xOX05PREVfSU5URVJOQUxfVkFMSURBVE9SIH0gZnJvbSAnLi4vZGlyZWN0aXZlcy9nbG4tcmVnZXgvZ2xuLW5vZGUtaW50ZXJuYWwtdmFsaWRhdG9yLmludGVyZmFjZSc7XG5pbXBvcnQgeyBHbG5CYXNpc0ZyYW1lIH0gZnJvbSAnLi4vX2NsYXNzZXMvZ2xuLWJhc2lzLWZyYW1lLmNsYXNzJztcbmltcG9ydCB7IEdsbkZyYW1lQ29uZmlnIH0gZnJvbSAnLi4vZ2xuLWZyYW1lL2dsbi1mcmFtZS1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IEdsbkZyYW1lU2l6ZSwgR2xuRnJhbWVTaXplVXRpbCB9IGZyb20gJy4uL2dsbi1mcmFtZS9nbG4tZnJhbWUtc2l6ZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgSHRtbEVsZW1VdGlsIH0gZnJvbSAnLi4vX3V0aWxzL2h0bWwtZWxlbS51dGlsJztcblxubGV0IHVuaXF1ZUlkQ291bnRlciA9IDA7XG5cbmV4cG9ydCBjb25zdCBHTE5fVEVYVEFSRUFfQ09ORklHID0gbmV3IEluamVjdGlvblRva2VuPEdsbkZyYW1lQ29uZmlnPignR0xOX1RFWFRBUkVBX0NPTkZJRycpO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdnbG4tdGV4dGFyZWEnLFxuICBleHBvcnRBczogJ2dsblRleHRhcmVhJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2dsbi10ZXh0YXJlYS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2dsbi10ZXh0YXJlYS5jb21wb25lbnQuc2NzcyddLFxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgcHJvdmlkZXJzOiBbXG4gICAgeyBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUiwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gR2xuVGV4dGFyZWFDb21wb25lbnQpLCBtdWx0aTogdHJ1ZSB9LFxuICAgIHsgcHJvdmlkZTogTkdfVkFMSURBVE9SUywgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gR2xuVGV4dGFyZWFDb21wb25lbnQpLCBtdWx0aTogdHJ1ZSB9LFxuICAgIHsgcHJvdmlkZTogR0xOX05PREVfSU5URVJOQUxfVkFMSURBVE9SLCB1c2VFeGlzdGluZzogR2xuVGV4dGFyZWFDb21wb25lbnQgfSxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgR2xuVGV4dGFyZWFDb21wb25lbnRcbiAgZXh0ZW5kcyBHbG5CYXNpc0ZyYW1lXG4gIGltcGxlbWVudHMgT25DaGFuZ2VzLCBPbkluaXQsIEFmdGVyQ29udGVudEluaXQsIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBWYWxpZGF0b3IsIEdsbk5vZGVJbnRlcm5hbFZhbGlkYXRvclxue1xuICAvLyBASW5wdXQoKVxuICAvLyBwdWJsaWMgaWQgPSBgZ2xudHgtJHt1bmlxdWVJZENvdW50ZXIrK31gOyAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBhdXRvQ29tcGxldGUgPSAnJztcbiAgQElucHV0KClcbiAgcHVibGljIGNudENvbHM6IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBjbnRSb3dzOiBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkO1xuICBASW5wdXQoKVxuICBwdWJsaWMgY29uZmlnOiBHbG5GcmFtZUNvbmZpZyB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBleHRlcmlvcjogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDsgLy8gR2xuRnJhbWVFeHRlcmlvclR5cGVcbiAgQElucHV0KClcbiAgcHVibGljIGZyYW1lU2l6ZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDsgLy8gR2xuRnJhbWVTaXplVHlwZVxuICBASW5wdXQoKVxuICBwdWJsaWMgaGVscGVyVGV4dDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgLy8gQElucHV0KClcbiAgLy8gcHVibGljIGlzRGlzYWJsZWQ6IHN0cmluZyB8IGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkOyAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIEBJbnB1dCgpXG4gIC8vIHB1YmxpYyBpc0Vycm9yOiBzdHJpbmcgfCBib29sZWFuIHwgbnVsbCB8IHVuZGVmaW5lZDsgLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBASW5wdXQoKVxuICAvLyBwdWJsaWMgaXNMYWJlbFNocmluazogc3RyaW5nIHwgYm9vbGVhbiB8IG51bGwgfCB1bmRlZmluZWQ7IC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgLy8gQElucHV0KClcbiAgLy8gcHVibGljIGlzTm9BbmltYXRpb246IHN0cmluZyB8IGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkOyAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIEBJbnB1dCgpXG4gIC8vIHB1YmxpYyBpc05vTGFiZWw6IHN0cmluZyB8IGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkOyAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIEBJbnB1dCgpXG4gIC8vIHB1YmxpYyBpc1JlYWRPbmx5OiBzdHJpbmcgfCBib29sZWFuIHwgbnVsbCB8IHVuZGVmaW5lZDsgLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBASW5wdXQoKVxuICAvLyBwdWJsaWMgaXNSZXF1aXJlZDogc3RyaW5nIHwgYm9vbGVhbiB8IG51bGwgfCB1bmRlZmluZWQ7Ly8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBASW5wdXQoKVxuICAvLyBwdWJsaWMgaXNWYWx1ZUluaXQ6IHN0cmluZyB8IGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkOyAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBsYWJlbDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgQElucHV0KClcbiAgcHVibGljIG1heExlbmd0aDogbnVtYmVyIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgQElucHV0KClcbiAgcHVibGljIG1heFJvd3M6IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBtaW5MZW5ndGg6IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBtaW5Sb3dzOiBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkO1xuICBASW5wdXQoKVxuICBwdWJsaWMgb3JuYW1MZkFsaWduOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkOyAvLyBPcm5hbUFsaWduXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBvcm5hbVJnQWxpZ246IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7IC8vIE9ybmFtQWxpZ25cbiAgQElucHV0KClcbiAgcHVibGljIHRhYkluZGV4ID0gMDtcbiAgQElucHV0KClcbiAgcHVibGljIHdkRnVsbDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcblxuICBAT3V0cHV0KClcbiAgcmVhZG9ubHkgZm9jdXNlZDogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KClcbiAgcmVhZG9ubHkgYmx1cmVkOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIC8vIEBPdXRwdXQoKVxuICAvLyByZWFkb25seSB3cml0ZVZhbHVlSW5pdDogRXZlbnRFbWl0dGVyPCgpID0+IHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcigpOyAvLyBGcm9tIEdsbkJhc2lzQnlGcmFtZVxuXG4gIEBWaWV3Q2hpbGQoJ3RleHRhcmVhRWxlbWVudCcpXG4gIHB1YmxpYyB0ZXh0YXJlYUVsZW1lbnRSZWY6IEVsZW1lbnRSZWYgfCBudWxsID0gbnVsbDtcblxuICBwdWJsaWMgY3VyckNvbmZpZzogR2xuRnJhbWVDb25maWcgfCBudWxsID0gbnVsbDtcbiAgcHVibGljIGN1cnJlbnRSb3dzID0gMTtcbiAgLy8gcHVibGljIGRpc2FibGVkOiBib29sZWFuIHwgbnVsbCA9IG51bGw7IC8vIEJpbmRpbmcgYXR0cmlidXRlIFwiaXNEaXNhYmxlZFwiLiAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIHB1YmxpYyBlcnJvcjogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAvLyBCaW5kaW5nIGF0dHJpYnV0ZSBcImlzRXJyb3JcIi4gLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICBwdWJsaWMgZm9ybUNvbnRyb2w6IEZvcm1Db250cm9sID0gbmV3IEZvcm1Db250cm9sKHsgdmFsdWU6IG51bGwsIGRpc2FibGVkOiBmYWxzZSB9LCBbXSk7XG4gIHB1YmxpYyBmb3JtR3JvdXA6IEZvcm1Hcm91cCA9IG5ldyBGb3JtR3JvdXAoeyB0ZXh0RGF0YTogdGhpcy5mb3JtQ29udHJvbCB9KTtcbiAgcHVibGljIGZyYW1lU2l6ZURlZmF1bHQgPSBHbG5GcmFtZVNpemVVdGlsLmdldFZhbHVlKEdsbkZyYW1lU2l6ZS5taWRkbGUpIHx8IDA7XG4gIHB1YmxpYyBpc0ZvY3VzZWQgPSBmYWxzZTtcbiAgcHVibGljIGlzRmlsbGVkID0gZmFsc2U7XG4gIC8vIHB1YmxpYyBpc1dyaXRlVmFsdWVJbml0OiBib29sZWFuIHwgbnVsbCA9IG51bGw7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgLy8gcHVibGljIGxhYmVsU2hyaW5rOiBib29sZWFuIHwgbnVsbCA9IG51bGw7IC8vIEJpbmRpbmcgYXR0cmlidXRlIFwiaXNMYWJlbFNocmlua1wiLiAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIHB1YmxpYyBub0FuaW1hdGlvbjogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAvLyBCaW5kaW5nIGF0dHJpYnV0ZSBcImlzTm9BbmltYXRpb25cIi4gLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBwdWJsaWMgbm9MYWJlbDogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAvLyBCaW5kaW5nIGF0dHJpYnV0ZSBcImlzTm9MYWJlbFwiLiAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIHB1YmxpYyByZWFkT25seTogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAvLyBCaW5kaW5nIGF0dHJpYnV0ZSBcImlzUmVhZE9ubHlcIi4gLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBwdWJsaWMgcmVxdWlyZWQ6IGJvb2xlYW4gfCBudWxsID0gbnVsbDsgLy8gQmluZGluZyBhdHRyaWJ1dGUgXCJpc1JlcXVpcmVkXCIuIC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgLy8gcHVibGljIHZhbHVlSW5pdDogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAvLyBCaW5kaW5nIGF0dHJpYnV0ZSBcImlzVmFsdWVJbml0XCIuIC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cblxuICBjb25zdHJ1Y3RvcihcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xuICAgIEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZDogT2JqZWN0LFxuICAgIGNoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBAT3B0aW9uYWwoKSBASW5qZWN0KEdMTl9URVhUQVJFQV9DT05GSUcpIHByaXZhdGUgcm9vdENvbmZpZzogR2xuRnJhbWVDb25maWcgfCBudWxsLFxuICAgIGhvc3RSZWY6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+LFxuICAgIHJlbmRlcmVyOiBSZW5kZXJlcjIsXG4gICAgbmdab25lOiBOZ1pvbmVcbiAgKSB7XG4gICAgc3VwZXIodW5pcXVlSWRDb3VudGVyKyssICdnbG50eCcsIGhvc3RSZWYsIHJlbmRlcmVyLCBjaGFuZ2VEZXRlY3RvclJlZiwgbmdab25lKTtcbiAgICB0aGlzLmN1cnJDb25maWcgPSB0aGlzLnJvb3RDb25maWc7XG4gICAgSHRtbEVsZW1VdGlsLnNldENsYXNzKHRoaXMucmVuZGVyZXIsIHRoaXMuaG9zdFJlZiwgJ2dsbi10ZXh0YXJlYScsIHRydWUpO1xuICAgIEh0bWxFbGVtVXRpbC5zZXRDbGFzcyh0aGlzLnJlbmRlcmVyLCB0aGlzLmhvc3RSZWYsICdnbG4tY29udHJvbCcsIHRydWUpO1xuICB9XG5cbiAgcHVibGljIG92ZXJyaWRlIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICAvLyBJbiB0aGUgR2xuQmFzaXNDb250cm9sLm5nT25DaGFuZ2VzKCksIHRoZSBkZWZpbml0aW9uIGlzIG1hZGU6XG4gICAgLy8gLSB0aGlzLmRpc2FibGVkID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzRGlzYWJsZWQpO1xuICAgIC8vIC0gdGhpcy5lcnJvciA9IEJvb2xlYW5VdGlsLmluaXQodGhpcy5pc0Vycm9yKTtcbiAgICAvLyAtIHRoaXMubGFiZWxTaHJpbmsgPSBCb29sZWFuVXRpbC5pbml0KHRoaXMuaXNMYWJlbFNocmluayk7XG4gICAgLy8gLSB0aGlzLm5vQW5pbWF0aW9uID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzTm9BbmltYXRpb24pO1xuICAgIC8vIC0gdGhpcy5ub0xhYmVsID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzTm9MYWJlbCk7XG4gICAgLy8gLSB0aGlzLnJlYWRPbmx5ID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzUmVhZE9ubHkpO1xuICAgIC8vIC0gdGhpcy5yZXF1aXJlZCA9IEJvb2xlYW5VdGlsLmluaXQodGhpcy5pc1JlcXVpcmVkKTtcbiAgICAvLyAtIHRoaXMudmFsdWVJbml0ID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzVmFsdWVJbml0KTtcbiAgICBzdXBlci5uZ09uQ2hhbmdlcyhjaGFuZ2VzKTtcbiAgICBpZiAoY2hhbmdlc1snY29uZmlnJ10pIHtcbiAgICAgIHRoaXMuY3VyckNvbmZpZyA9IHsgLi4udGhpcy5yb290Q29uZmlnLCAuLi50aGlzLmNvbmZpZyB9O1xuICAgIH1cbiAgICBpZiAoY2hhbmdlc1snaXNSZXF1aXJlZCddIHx8IGNoYW5nZXNbJ21pbkxlbmd0aCddIHx8IGNoYW5nZXNbJ21heExlbmd0aCddKSB7XG4gICAgICB0aGlzLnByZXBhcmVGb3JtR3JvdXAodGhpcy5yZXF1aXJlZCwgdGhpcy5taW5MZW5ndGggfHwgbnVsbCwgdGhpcy5tYXhMZW5ndGggfHwgbnVsbCk7XG4gICAgfVxuICAgIGlmIChjaGFuZ2VzWydjbnRSb3dzJ10gfHwgY2hhbmdlc1snbWluUm93cyddIHx8IGNoYW5nZXNbJ21heFJvd3MnXSkge1xuICAgICAgdGhpcy5jdXJyZW50Um93cyA9IHRoaXMuY250Um93cyB8fCB0aGlzLmdldEN1cnJlbnRSb3dzKHRoaXMuZ2V0TnVtYmVyTGluZXModGhpcy5mb3JtQ29udHJvbC52YWx1ZSksIHRoaXMubWluUm93cywgdGhpcy5tYXhSb3dzKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgb3ZlcnJpZGUgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgc3VwZXIubmdPbkluaXQoKTtcbiAgfVxuXG4gIHB1YmxpYyBvdmVycmlkZSBuZ0FmdGVyQ29udGVudEluaXQoKTogdm9pZCB7XG4gICAgc3VwZXIubmdBZnRlckNvbnRlbnRJbml0KCk7XG4gIH1cblxuICAvLyAqKiBDb250cm9sVmFsdWVBY2Nlc3NvciAtIHN0YXJ0ICoqXG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgcHVibGljIG92ZXJyaWRlIHdyaXRlVmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xuICAgIGNvbnN0IGlzRmlsbGVkT2xkID0gISF0aGlzLmZvcm1Db250cm9sLnZhbHVlO1xuICAgIGNvbnN0IGNudExpbmVzT2xkID0gdGhpcy5nZXROdW1iZXJMaW5lcyh0aGlzLmZvcm1Db250cm9sLnZhbHVlKTtcbiAgICB0aGlzLmZvcm1Db250cm9sLnNldFZhbHVlKHZhbHVlLCB7IGVtaXRFdmVudDogZmFsc2UgfSk7XG4gICAgdGhpcy5pc0ZpbGxlZCA9IHRoaXMuZm9ybUNvbnRyb2wudmFsdWUgIT09ICcnICYmIHRoaXMuZm9ybUNvbnRyb2wudmFsdWUgIT0gbnVsbDtcbiAgICBjb25zdCBjbnRMaW5lcyA9IHRoaXMuZ2V0TnVtYmVyTGluZXModGhpcy5mb3JtQ29udHJvbC52YWx1ZSk7XG4gICAgaWYgKGNudExpbmVzT2xkICE9IGNudExpbmVzKSB7XG4gICAgICB0aGlzLmN1cnJlbnRSb3dzID0gdGhpcy5jbnRSb3dzIHx8IHRoaXMuZ2V0Q3VycmVudFJvd3ModGhpcy5nZXROdW1iZXJMaW5lcyh0aGlzLmZvcm1Db250cm9sLnZhbHVlKSwgdGhpcy5taW5Sb3dzLCB0aGlzLm1heFJvd3MpO1xuICAgIH1cbiAgICBpZiAoaXNGaWxsZWRPbGQgIT09IHRoaXMuaXNGaWxsZWQgfHwgY250TGluZXNPbGQgIT0gY250TGluZXMpIHtcbiAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICAgIHN1cGVyLndyaXRlVmFsdWUodmFsdWUpO1xuICB9XG5cbiAgcHVibGljIG92ZXJyaWRlIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpc2FibGVkICE9PSBpc0Rpc2FibGVkKSB7XG4gICAgICBpc0Rpc2FibGVkID8gdGhpcy5mb3JtR3JvdXAuZGlzYWJsZSgpIDogdGhpcy5mb3JtR3JvdXAuZW5hYmxlKCk7XG4gICAgICBzdXBlci5zZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQpO1xuICAgIH1cbiAgfVxuXG4gIC8vICoqIENvbnRyb2xWYWx1ZUFjY2Vzc29yIC0gZmluaXNoICoqXG5cbiAgLy8gKiogVmFsaWRhdG9yIC0gc3RhcnQgKipcblxuICBwdWJsaWMgdmFsaWRhdGUoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwge1xuICAgIHJldHVybiAhY29udHJvbCA/IG51bGwgOiB0aGlzLmZvcm1Db250cm9sLmVycm9ycztcbiAgfVxuXG4gIC8vICoqIFZhbGlkYXRvciAtIGZpbmlzaCAqKlxuXG4gIC8vICoqIEdsbk5vZGVJbnRlcm5hbFZhbGlkYXRvciAtIHN0YXJ0ICoqXG5cbiAgcHVibGljIGFkZFZhbGlkYXRvcnModmFsaWRhdG9yczogVmFsaWRhdG9yRm4gfCBWYWxpZGF0b3JGbltdKTogdm9pZCB7XG4gICAgaWYgKHZhbGlkYXRvcnMgIT0gbnVsbCkge1xuICAgICAgdGhpcy5mb3JtQ29udHJvbC5hZGRWYWxpZGF0b3JzKHZhbGlkYXRvcnMpO1xuICAgICAgdGhpcy5mb3JtQ29udHJvbC51cGRhdGVWYWx1ZUFuZFZhbGlkaXR5KCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGFkZEFzeW5jVmFsaWRhdG9ycyh2YWxpZGF0b3JzOiBBc3luY1ZhbGlkYXRvckZuIHwgQXN5bmNWYWxpZGF0b3JGbltdKTogdm9pZCB7XG4gICAgaWYgKHZhbGlkYXRvcnMgIT0gbnVsbCkge1xuICAgICAgdGhpcy5mb3JtQ29udHJvbC5hZGRBc3luY1ZhbGlkYXRvcnModmFsaWRhdG9ycyk7XG4gICAgICB0aGlzLmZvcm1Db250cm9sLnVwZGF0ZVZhbHVlQW5kVmFsaWRpdHkoKTtcbiAgICB9XG4gIH1cblxuICAvLyAqKiBHbG5Ob2RlSW50ZXJuYWxWYWxpZGF0b3IgLSBmaW5pc2ggKipcblxuICAvLyAqKiBQdWJsaWMgQVBJICoqXG5cbiAgcHVibGljIGZvY3VzKCk6IHZvaWQge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpICYmICEhdGhpcy50ZXh0YXJlYUVsZW1lbnRSZWYpIHtcbiAgICAgICh0aGlzLnRleHRhcmVhRWxlbWVudFJlZi5uYXRpdmVFbGVtZW50IGFzIEhUTUxJbnB1dEVsZW1lbnQpLmZvY3VzKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGRvRm9jdXMoKTogdm9pZCB7XG4gICAgdGhpcy5pc0ZvY3VzZWQgPSB0cnVlO1xuICAgIHRoaXMuZm9jdXNTdGF0ZSh0aGlzLnJlbmRlcmVyLCB0aGlzLmhvc3RSZWYsIHRoaXMuaXNGb2N1c2VkKTtcbiAgICB0aGlzLmZvY3VzZWQuZW1pdCgpO1xuICB9XG5cbiAgcHVibGljIGRvQmx1cigpOiB2b2lkIHtcbiAgICB0aGlzLmlzRm9jdXNlZCA9IGZhbHNlO1xuICAgIHRoaXMuZm9jdXNTdGF0ZSh0aGlzLnJlbmRlcmVyLCB0aGlzLmhvc3RSZWYsIHRoaXMuaXNGb2N1c2VkKTtcbiAgICB0aGlzLmlzRmlsbGVkID0gISF0aGlzLmZvcm1Db250cm9sLnZhbHVlO1xuICAgIHRoaXMub25Ub3VjaGVkKCk7XG4gICAgdGhpcy5ibHVyZWQuZW1pdCgpO1xuICB9XG5cbiAgcHVibGljIGRvSW5wdXQoZXZlbnQ6IEV2ZW50KTogdm9pZCB7XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci9pc3N1ZXMvOTU4NyBcImV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpIGNhbGxlZCBmcm9tIGxpc3RlbmVycyBub3Qgd29ya2luZ1wiXG4gICAgLy8gQWRkZWQgRXZlbnQuY2FuY2VsQnViYmxlIGNoZWNrIHRvIG1ha2Ugc3VyZSB0aGVyZSB3YXMgbm8gY2FsbCB0byBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSBpbiBwcmV2aW91cyBoYW5kbGVycy5cbiAgICBpZiAoISFldmVudCAmJiAhZXZlbnQuY2FuY2VsQnViYmxlKSB7XG4gICAgICB0aGlzLm9uQ2hhbmdlKHRoaXMuZm9ybUNvbnRyb2wudmFsdWUpO1xuICAgICAgdGhpcy5jdXJyZW50Um93cyA9IHRoaXMuY250Um93cyB8fCB0aGlzLmdldEN1cnJlbnRSb3dzKHRoaXMuZ2V0TnVtYmVyTGluZXModGhpcy5mb3JtQ29udHJvbC52YWx1ZSksIHRoaXMubWluUm93cywgdGhpcy5tYXhSb3dzKTtcbiAgICB9XG4gIH1cblxuICAvLyAqKiBQcml2YXRlIEFQSSAqKlxuXG4gIHByaXZhdGUgcHJlcGFyZUZvcm1Hcm91cChpc1JlcXVpcmVkOiBib29sZWFuIHwgbnVsbCwgbWluTGVuZ3RoOiBudW1iZXIgfCBudWxsLCBtYXhMZW5ndGg6IG51bWJlciB8IG51bGwpOiB2b2lkIHtcbiAgICB0aGlzLmZvcm1Db250cm9sLmNsZWFyVmFsaWRhdG9ycygpO1xuICAgIGNvbnN0IG5ld1ZhbGlkYXRvcjogVmFsaWRhdG9yRm5bXSA9IFtdO1xuICAgIGlmIChpc1JlcXVpcmVkKSB7XG4gICAgICBuZXdWYWxpZGF0b3IucHVzaChWYWxpZGF0b3JzLnJlcXVpcmVkKTtcbiAgICB9XG4gICAgaWYgKCEhbWluTGVuZ3RoICYmIG1pbkxlbmd0aCA+IDApIHtcbiAgICAgIG5ld1ZhbGlkYXRvci5wdXNoKFZhbGlkYXRvcnMubWluTGVuZ3RoKG1pbkxlbmd0aCkpO1xuICAgIH1cbiAgICBpZiAoISFtYXhMZW5ndGggJiYgbWF4TGVuZ3RoID4gMCkge1xuICAgICAgbmV3VmFsaWRhdG9yLnB1c2goVmFsaWRhdG9ycy5tYXhMZW5ndGgobWF4TGVuZ3RoKSk7XG4gICAgfVxuICAgIHRoaXMuZm9ybUNvbnRyb2wuc2V0VmFsaWRhdG9ycyhuZXdWYWxpZGF0b3IpO1xuICB9XG5cbiAgcHJpdmF0ZSBmb2N1c1N0YXRlKHJlbmRlcmVyOiBSZW5kZXJlcjIsIGVsZW06IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+LCB2YWx1ZTogYm9vbGVhbik6IHZvaWQge1xuICAgIEh0bWxFbGVtVXRpbC5zZXRDbGFzcyhyZW5kZXJlciwgZWxlbSwgJ2dsbi1mb2N1c2VkJywgdmFsdWUgfHwgZmFsc2UpO1xuICAgIEh0bWxFbGVtVXRpbC5zZXRBdHRyKHJlbmRlcmVyLCBlbGVtLCAnZm9jJywgdmFsdWUgPyAnJyA6IG51bGwpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDdXJyZW50Um93cyhudW1iZXJPZkxpbmVzOiBudW1iZXIsIG1pblJvd3M6IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQsIG1heFJvd3M6IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQpOiBudW1iZXIge1xuICAgIGxldCByZXN1bHQgPSBudW1iZXJPZkxpbmVzID4gMCA/IG51bWJlck9mTGluZXMgOiAxO1xuICAgIGlmICghIW1pblJvd3MgJiYgbWluUm93cyA+IDAgJiYgbWluUm93cyA+IHJlc3VsdCkge1xuICAgICAgcmVzdWx0ID0gbWluUm93cztcbiAgICB9XG4gICAgaWYgKCEhbWF4Um93cyAmJiBtYXhSb3dzID4gMCAmJiByZXN1bHQgPiBtYXhSb3dzKSB7XG4gICAgICByZXN1bHQgPSBtYXhSb3dzO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHJpdmF0ZSBnZXROdW1iZXJMaW5lcyh2YWx1ZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICByZXR1cm4gKHZhbHVlIHx8ICcnKS5zcGxpdCgnXFxuJykubGVuZ3RoO1xuICB9XG59XG4iLCI8bmctY29udGFpbmVyIFtmb3JtR3JvdXBdPVwiZm9ybUdyb3VwXCI+XG4gIDxkaXYgY2xhc3M9XCJnbG50eC13cmFwXCJcbiAgICBbZ2xuRnJhbWVFeHRlcmlvcklucHV0XT1cImV4dGVyaW9yIHx8IGN1cnJDb25maWc/LmV4dGVyaW9yXCJcbiAgICAjZ2xuRnJhbWVFeHRlcmlvcklucHV0PVwiZ2xuRnJhbWVFeHRlcmlvcklucHV0XCJcbiAgICBbZ2xuRnJhbWVFeHRlcmlvcklucHV0RWxlbWVudFJlZl09XCJob3N0UmVmXCJcbiAgICAoZ2xuRnJhbWVFeHRlcmlvcklucHV0Q2hhbmdlKT1cImdsbkZyYW1lU2l6ZS51cGRhdGVQYWRkaW5nVmVyQW5kSG9yKClcIj5cbiAgICA8Z2xuLWZyYW1lIFtjb25maWddPVwiY29uZmlnXCJcbiAgICAgIFtleHRlcmlvcl09XCJnbG5GcmFtZUV4dGVyaW9ySW5wdXQuZXh0ZXJpb3JcIlxuICAgICAgW2lzRGlzYWJsZWRdPVwiZGlzYWJsZWRcIlxuICAgICAgW2lzRXJyb3JdPVwiISFmb3JtQ29udHJvbC5lcnJvcnMgfHwgZXJyb3JcIlxuICAgICAgW2lzRmlsbGVkXT1cImlzRmlsbGVkXCJcbiAgICAgIFtpc0xhYmVsU2hyaW5rXT1cImxhYmVsU2hyaW5rIHx8IGN1cnJDb25maWc/LmlzTGFiZWxTaHJpbmtcIlxuICAgICAgW2lzTm9BbmltYXRpb25dPVwibm9BbmltYXRpb24gfHwgY3VyckNvbmZpZz8uaXNOb0FuaW1hdGlvbiB8fCBpc1dyaXRlVmFsdWVJbml0XCJcbiAgICAgIFtpc05vTGFiZWxdPVwibm9MYWJlbCB8fCBjdXJyQ29uZmlnPy5pc05vTGFiZWxcIlxuICAgICAgW2lzUmVxdWlyZWRdPVwicmVxdWlyZWRcIlxuICAgICAgW2xhYmVsXT1cImxhYmVsXCJcbiAgICAgIFtnbG5GcmFtZVNpemVdPVwiZnJhbWVTaXplIHx8IGN1cnJDb25maWc/LmZyYW1lU2l6ZVwiXG4gICAgICAjZ2xuRnJhbWVTaXplPVwiZ2xuRnJhbWVTaXplXCJcbiAgICAgIFtnbG5GcmFtZVNpemVFbGVtZW50UmVmXT1cImhvc3RSZWZcIlxuICAgICAgW2dsbkZyYW1lU2l6ZVZhbHVlXT1cImN1cnJDb25maWc/LmZyYW1lU2l6ZVZhbHVlIHx8IGZyYW1lU2l6ZURlZmF1bHRcIlxuICAgICAgW2dsbkZyYW1lU2l6ZUxhYmVsUGRdPVwiY3VyckNvbmZpZz8ubGFiZWxQZFwiXG4gICAgICBbZ2xuRnJhbWVTaXplUHJlcGFyZV09XCJnbG5GcmFtZUV4dGVyaW9ySW5wdXRcIlxuICAgICAgZ2xuRnJhbWVPcm5hbWVudFxuICAgICAgW2dsbkZyYW1lT3JuYW1lbnRMZkFsaWduXT1cIm9ybmFtTGZBbGlnbiB8fCBjdXJyQ29uZmlnPy5vcm5hbUxmQWxpZ25cIlxuICAgICAgW2dsbkZyYW1lT3JuYW1lbnRSZ0FsaWduXT1cIm9ybmFtUmdBbGlnbiB8fCBjdXJyQ29uZmlnPy5vcm5hbVJnQWxpZ25cIlxuICAgICAgW2dsbkZyYW1lT3JuYW1lbnRQYXRoXT1cIicvZGl2ezB9J1wiPlxuXG4gICAgICA8c3BhbiBnbG5mci1vcm4tbGZcbiAgICAgICAgY2xhc3M9XCJnbG4tb3JuYW0tbGZcIj5cbiAgICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwiW2dsbi1vcm4tbGZdXCI+PC9uZy1jb250ZW50PlxuICAgICAgPC9zcGFuPlxuICAgICAgPHNwYW4gZ2xuZnItb3JuLXJnXG4gICAgICAgIGNsYXNzPVwiZ2xuLW9ybmFtLXJnXCI+XG4gICAgICAgIDxuZy1jb250ZW50IHNlbGVjdD1cIltnbG4tb3JuLXJnXVwiPjwvbmctY29udGVudD5cbiAgICAgIDwvc3Bhbj5cblxuICAgICAgPHRleHRhcmVhICN0ZXh0YXJlYUVsZW1lbnRcbiAgICAgICAgZm9ybUNvbnRyb2xOYW1lPVwidGV4dERhdGFcIlxuICAgICAgICBnbG5mci1tci12ZXJcbiAgICAgICAgZ2xuZnItcGQtaG9yXG4gICAgICAgIGdsbmZyLWVsZW1cbiAgICAgICAgW2F0dHIuaWRdPVwiaWQgKyAnX3RleHRhcmVhJ1wiXG4gICAgICAgIFtyb3dzXT1cImN1cnJlbnRSb3dzXCJcbiAgICAgICAgW25nQ2xhc3NdPVwiWydnbG50eC10ZXh0YXJlYScsIChyZWFkT25seSA/ICdnbG4tcmVhZG9ubHknIDogJycpXVwiXG4gICAgICAgIFthdHRyLmRpc2FibGVkXT1cImRpc2FibGVkID8gJyc6IG51bGxcIlxuICAgICAgICBbYXR0ci5hdXRvY29tcGxldGVdPVwiISFhdXRvQ29tcGxldGUgPyBhdXRvQ29tcGxldGUgOiBudWxsXCJcbiAgICAgICAgW2F0dHIucmVhZG9ubHldPVwicmVhZE9ubHkgPyAnJzogbnVsbFwiXG4gICAgICAgIFthdHRyLnRhYmluZGV4XT1cIiFkaXNhYmxlZCA/IHRhYkluZGV4IDogbnVsbFwiXG4gICAgICAgIFtjb2xzXT1cImNudENvbHNcIlxuICAgICAgICAoZm9jdXMpPVwiZG9Gb2N1cygpXCJcbiAgICAgICAgKGJsdXIpPVwiZG9CbHVyKClcIlxuICAgICAgICAoaW5wdXQpPVwiZG9JbnB1dCgkZXZlbnQpXCJcbiAgICAgICAgKGNsaWNrKT1cIiRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcIj5cbiAgICAgIDwvdGV4dGFyZWE+XG5cbiAgICA8L2dsbi1mcmFtZT5cbiAgPC9kaXY+XG48L25nLWNvbnRhaW5lcj5cbjxnbG4taGludC1vci1lcnJvciAqbmdJZj1cIiEhaGVscGVyVGV4dFwiXG4gIFt0ZXh0XT1cImhlbHBlclRleHRcIlxuICBbaXNFcnJvcl09XCIhIWZvcm1Db250cm9sLmVycm9ycyB8fCBlcnJvclwiXG4gIFtpc0ZvY3VzZWRdPVwiaXNGb2N1c2VkXCJcbiAgW2lzRGlzYWJsZWRdPVwiZGlzYWJsZWRcIj5cbjwvZ2xuLWhpbnQtb3ItZXJyb3I+Il19