import { isPlatformBrowser } from '@angular/common';
import { ChangeDetectionStrategy, Component, EventEmitter, forwardRef, Inject, InjectionToken, Input, Optional, Output, PLATFORM_ID, ViewChild, ViewEncapsulation, } from '@angular/core';
import { FormControl, FormGroup, NG_VALIDATORS, NG_VALUE_ACCESSOR, Validators, } from '@angular/forms';
import { GLN_NODE_INTERNAL_VALIDATOR } from '../directives/gln-regex/gln-node-internal-validator.interface';
import { GlnBasisFrame } from '../_classes/gln-basis-frame.class';
import { GlnFrameSize, GlnFrameSizeUtil } from '../gln-frame/gln-frame-size.interface';
import { GlnInputType, GlnInputTypeUtil } from '../gln-input/gln-input.interface';
import { HtmlElemUtil } from '../_utils/html-elem.util';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/forms";
import * as i3 from "../directives/gln-frame-exterior-input/gln-frame-exterior-input.directive";
import * as i4 from "../gln-frame/gln-frame.component";
import * as i5 from "../directives/gln-frame-ornament/gln-frame-ornament.directive";
import * as i6 from "../directives/gln-frame-size/gln-frame-size.directive";
import * as i7 from "../gln-hint-or-error/gln-hint-or-error.component";
let uniqueIdCounter = 0;
export const GLN_INPUT_CONFIG = new InjectionToken('GLN_INPUT_CONFIG');
export class GlnInputComponent extends GlnBasisFrame {
    // public valueInit: boolean | null = null; // Binding attribute "isValueInit". // Is in GlnBasisControl.
    constructor(
    // eslint-disable-next-line @typescript-eslint/ban-types
    platformId, changeDetectorRef, rootConfig, hostRef, renderer, ngZone) {
        super(uniqueIdCounter++, 'glnin', hostRef, renderer, changeDetectorRef, ngZone);
        this.platformId = platformId;
        this.rootConfig = rootConfig;
        // @Input()
        // public id = `glnin-${uniqueIdCounter++}`; // Is in GlnBasisControl.
        this.autoComplete = '';
        this.pattern = '';
        this.tabIndex = 0;
        this.type = GlnInputType.text.valueOf();
        this.focused = new EventEmitter();
        this.blured = new EventEmitter();
        // @Output()
        // readonly writeValueInit: EventEmitter<() => void> = new EventEmitter(); // From GlnBasisByFrame
        this.inputElementRef = null;
        this.currConfig = null;
        // public disabled: boolean | null = null; // Binding attribute "isDisabled". // Is in GlnBasisControl.
        // public error: boolean | null = null; // Binding attribute "isError". // Is in GlnBasisControl.
        this.formControl = new FormControl({ value: null, disabled: false }, []);
        this.formGroup = new FormGroup({ textData: this.formControl });
        this.frameSizeDefault = GlnFrameSizeUtil.getValue(GlnFrameSize.middle) || 0;
        this.isFocused = false;
        this.isFilled = false;
        // public isWriteValueInit: boolean | null = null;                            // Is in GlnBasisControl.
        // public labelShrink: boolean | null = null; // Binding attribute "isLabelShrink". // Is in GlnBasisControl.
        // public noAnimation: boolean | null = null; // Binding attribute "isNoAnimation". // Is in GlnBasisControl.
        // public noLabel: boolean | null = null; // Binding attribute "isNoLabel". // Is in GlnBasisControl.
        // public readOnly: boolean | null = null; // Binding attribute "isReadOnly". // Is in GlnBasisControl.
        // public required: boolean | null = null; // Binding attribute "isRequired". // Is in GlnBasisControl.
        this.typeVal = GlnInputType.text;
        this.currConfig = this.rootConfig;
        HtmlElemUtil.setClass(this.renderer, this.hostRef, 'gln-input', true);
        HtmlElemUtil.setClass(this.renderer, this.hostRef, 'gln-control', true);
    }
    ngOnChanges(changes) {
        // In the GlnBasisControl.ngOnChanges(), the definition is made:
        // - this.disabled = BooleanUtil.init(this.isDisabled);
        // - this.error = BooleanUtil.init(this.isError);
        // - this.labelShrink = BooleanUtil.init(this.isLabelShrink);
        // - this.noAnimation = BooleanUtil.init(this.isNoAnimation);
        // - this.noLabel = BooleanUtil.init(this.isNoLabel);
        // - this.readOnly = BooleanUtil.init(this.isReadOnly);
        // - this.required = BooleanUtil.init(this.isRequired);
        // - this.valueInit = BooleanUtil.init(this.isValueInit);
        super.ngOnChanges(changes);
        if (changes['type']) {
            this.typeVal = GlnInputTypeUtil.create(this.type) || GlnInputType.text;
        }
        if (changes['config']) {
            this.currConfig = { ...this.rootConfig, ...this.config };
        }
        if (changes['isRequired'] || changes['minLength'] || changes['maxLength']) {
            this.prepareFormGroup(this.required, this.minLength, this.maxLength);
        }
    }
    ngOnInit() {
        super.ngOnInit();
    }
    ngAfterContentInit() {
        super.ngAfterContentInit();
    }
    // ** ControlValueAccessor - start **
    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any
    writeValue(value) {
        const isFilledOld = !!this.formControl.value;
        this.formControl.setValue(value, { emitEvent: false });
        this.isFilled = this.formControl.value !== '' && this.formControl.value != null;
        if (isFilledOld !== this.isFilled) {
            this.changeDetectorRef.markForCheck();
        }
        super.writeValue(value);
    }
    setDisabledState(isDisabled) {
        if (this.disabled !== isDisabled) {
            isDisabled ? this.formGroup.disable() : this.formGroup.enable();
            super.setDisabledState(isDisabled);
        }
    }
    // ** ControlValueAccessor - finish **
    // ** Validator - start **
    validate(control) {
        return !control ? null : this.formControl.errors;
    }
    // ** Validator - finish **
    // ** GlnNodeInternalValidator - start **
    addValidators(validators) {
        if (validators != null) {
            this.formControl.addValidators(validators);
            this.formControl.updateValueAndValidity();
        }
    }
    addAsyncValidators(validators) {
        if (validators != null) {
            this.formControl.addAsyncValidators(validators);
            this.formControl.updateValueAndValidity();
        }
    }
    // ** GlnNodeInternalValidator - finish **
    // ** Public API **
    focus() {
        if (isPlatformBrowser(this.platformId) && !!this.inputElementRef) {
            this.inputElementRef.nativeElement.focus();
        }
    }
    doFocus() {
        this.isFocused = true;
        this.focusState(this.renderer, this.hostRef, this.isFocused);
        this.focused.emit();
    }
    doBlur() {
        this.isFocused = false;
        this.focusState(this.renderer, this.hostRef, this.isFocused);
        this.isFilled = !!this.formControl.value;
        this.onTouched();
        this.blured.emit();
    }
    doInput(event) {
        // https://github.com/angular/angular/issues/9587 "event.stopImmediatePropagation() called from listeners not working"
        // Added Event.cancelBubble check to make sure there was no call to event.stopImmediatePropagation() in previous handlers.
        if (!!event && !event.cancelBubble) {
            this.onChange(this.formControl.value);
        }
    }
    // ** Private API **
    prepareFormGroup(isRequired, minLength, maxLength) {
        this.formControl.clearValidators();
        const newValidator = [];
        if (isRequired) {
            newValidator.push(Validators.required);
        }
        if (!!minLength && minLength > 0) {
            newValidator.push(Validators.minLength(minLength));
        }
        if (!!maxLength && maxLength > 0) {
            newValidator.push(Validators.maxLength(maxLength));
        }
        this.formControl.setValidators(newValidator);
    }
    focusState(renderer, elem, value) {
        HtmlElemUtil.setClass(renderer, elem, 'gln-focused', value || false);
        HtmlElemUtil.setAttr(renderer, elem, 'foc', value ? '' : null);
    }
}
GlnInputComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.1.2", ngImport: i0, type: GlnInputComponent, deps: [{ token: PLATFORM_ID }, { token: i0.ChangeDetectorRef }, { token: GLN_INPUT_CONFIG, optional: true }, { token: i0.ElementRef }, { token: i0.Renderer2 }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component });
GlnInputComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.1.2", type: GlnInputComponent, selector: "gln-input", inputs: { autoComplete: "autoComplete", config: "config", exterior: "exterior", frameSize: "frameSize", helperText: "helperText", label: "label", max: "max", maxLength: "maxLength", min: "min", minLength: "minLength", ornamLfAlign: "ornamLfAlign", ornamRgAlign: "ornamRgAlign", pattern: "pattern", step: "step", tabIndex: "tabIndex", type: "type", wdFull: "wdFull" }, outputs: { focused: "focused", blured: "blured" }, providers: [
        { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() => GlnInputComponent), multi: true },
        { provide: NG_VALIDATORS, useExisting: forwardRef(() => GlnInputComponent), multi: true },
        { provide: GLN_NODE_INTERNAL_VALIDATOR, useExisting: GlnInputComponent },
    ], viewQueries: [{ propertyName: "inputElementRef", first: true, predicate: ["inputElement"], descendants: true }], exportAs: ["glnInput"], usesInheritance: true, usesOnChanges: true, ngImport: i0, template: "<ng-container [formGroup]=\"formGroup\">\n  <div class=\"glnin-wrap\"\n    [glnFrameExteriorInput]=\"exterior || currConfig?.exterior\"\n    #glnFrameExteriorInput=\"glnFrameExteriorInput\"\n    [glnFrameExteriorInputElementRef]=\"hostRef\"\n    (glnFrameExteriorInputChange)=\"glnFrameSize.updatePaddingVerAndHor()\">\n    <gln-frame [config]=\"currConfig\"\n      [exterior]=\"glnFrameExteriorInput.exterior\"\n      [isDisabled]=\"disabled\"\n      [isError]=\"!!formControl.errors || error\"\n      [isFilled]=\"isFilled\"\n      [isLabelShrink]=\"labelShrink || currConfig?.isLabelShrink\"\n      [isNoAnimation]=\"noAnimation || currConfig?.isNoAnimation || isWriteValueInit\"\n      [isNoLabel]=\"noLabel || currConfig?.isNoLabel\"\n      [isRequired]=\"required\"\n      [label]=\"label\"\n      [glnFrameSize]=\"frameSize || currConfig?.frameSize\"\n      #glnFrameSize=\"glnFrameSize\"\n      [glnFrameSizeElementRef]=\"hostRef\"\n      [glnFrameSizeValue]=\"currConfig?.frameSizeValue || frameSizeDefault\"\n      [glnFrameSizeLabelPd]=\"currConfig?.labelPd\"\n      [glnFrameSizePrepare]=\"glnFrameExteriorInput\"\n      glnFrameOrnament\n      [glnFrameOrnamentLfAlign]=\"ornamLfAlign || currConfig?.ornamLfAlign\"\n      [glnFrameOrnamentRgAlign]=\"ornamRgAlign || currConfig?.ornamRgAlign\"\n      [glnFrameOrnamentPath]=\"'/div{0}'\">\n\n      <span glnfr-orn-lf\n        class=\"gln-ornam-lf\">\n        <ng-content select=\"[gln-orn-lf]\"></ng-content>\n      </span>\n      <span glnfr-orn-rg\n        class=\"gln-ornam-rg\">\n        <ng-content select=\"[gln-orn-rg]\"></ng-content>\n      </span>\n\n      <input #inputElement\n        formControlName=\"textData\"\n        glnfr-pd-ver\n        glnfr-pd-hor\n        glnfr-elem\n        [attr.id]=\"id + '_input'\"\n        [type]=\"typeVal\"\n        [ngClass]=\"['glnin-input', (readOnly ? 'gln-readonly' : '')]\"\n        [attr.disabled]=\"disabled ? '': null\"\n        [attr.autocomplete]=\"!!autoComplete ? autoComplete : null\"\n        [attr.readonly]=\"readOnly ? '': null\"\n        [attr.min]=\"min\"\n        [attr.max]=\"max\"\n        [attr.step]=\"step\"\n        [attr.tabindex]=\"!disabled ? tabIndex : null\"\n        [pattern]=\"pattern\"\n        (focus)=\"doFocus()\"\n        (blur)=\"doBlur()\"\n        (input)=\"doInput($event)\" />\n\n    </gln-frame>\n  </div>\n</ng-container>\n<gln-hint-or-error *ngIf=\"!!helperText\"\n  [text]=\"helperText\"\n  [isError]=\"!!formControl.errors || error\"\n  [isFocused]=\"isFocused\"\n  [isDisabled]=\"disabled\">\n</gln-hint-or-error>", styles: ["gln-input{display:inline-flex;flex-direction:column}gln-input[wdFull]{width:100%}gln-input[wdFull] gln-frame>div>[glnfr-elem]{width:100%}gln-input[noHeEllipsis] gln-hint-or-error{white-space:normal;overflow:visible;text-overflow:clip}gln-input .glnin-input{font-size:inherit;font-family:inherit;letter-spacing:inherit;color:inherit;border:0;box-sizing:content-box;background:none;margin:0;padding:0}gln-input .glnin-input:focus{outline:0}gln-input gln-hint-or-error{padding-left:var(--glnin-he-pd-lf, var(--glnfrs-pd-lf));padding-right:var(--glnin-he-pd-rg, var(--glnfrs-pd-rg))}\n"], dependencies: [{ kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i2.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i2.PatternValidator, selector: "[pattern][formControlName],[pattern][formControl],[pattern][ngModel]", inputs: ["pattern"] }, { kind: "directive", type: i2.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i2.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "directive", type: i3.GlnFrameExteriorInputDirective, selector: "[glnFrameExteriorInput]", inputs: ["glnFrameExteriorInput", "glnFrameExteriorInputElementRef"], outputs: ["glnFrameExteriorInputChange"], exportAs: ["glnFrameExteriorInput"] }, { kind: "component", type: i4.GlnFrameComponent, selector: "gln-frame", inputs: ["config", "exterior", "isDisabled", "isError", "isFilled", "isLabelShrink", "isNoAnimation", "isNoLabel", "isRequired", "label"], exportAs: ["glnFrame"] }, { kind: "directive", type: i5.GlnFrameOrnamentDirective, selector: "[glnFrameOrnament]", inputs: ["glnFrameOrnamentLfAlign", "glnFrameOrnamentRgAlign", "glnFrameOrnamentElementRef", "glnFrameOrnamentPath", "glnFrameOrnamentAfterContent"], exportAs: ["glnFrameOrnament"] }, { kind: "directive", type: i6.GlnFrameSizeDirective, selector: "[glnFrameSize]", inputs: ["glnFrameSize", "glnFrameSizeValue", "glnFrameSizeLabelPd", "glnFrameSizeElementRef", "glnFrameSizePrepare", "glnFrameSizeModify"], outputs: ["glnFrameSizeChange"], exportAs: ["glnFrameSize"] }, { kind: "component", type: i7.GlnHintOrErrorComponent, selector: "gln-hint-or-error", inputs: ["text", "isError", "isFocused", "isDisabled"], exportAs: ["glnHintOrError"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.1.2", ngImport: i0, type: GlnInputComponent, decorators: [{
            type: Component,
            args: [{ selector: 'gln-input', exportAs: 'glnInput', encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, providers: [
                        { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() => GlnInputComponent), multi: true },
                        { provide: NG_VALIDATORS, useExisting: forwardRef(() => GlnInputComponent), multi: true },
                        { provide: GLN_NODE_INTERNAL_VALIDATOR, useExisting: GlnInputComponent },
                    ], template: "<ng-container [formGroup]=\"formGroup\">\n  <div class=\"glnin-wrap\"\n    [glnFrameExteriorInput]=\"exterior || currConfig?.exterior\"\n    #glnFrameExteriorInput=\"glnFrameExteriorInput\"\n    [glnFrameExteriorInputElementRef]=\"hostRef\"\n    (glnFrameExteriorInputChange)=\"glnFrameSize.updatePaddingVerAndHor()\">\n    <gln-frame [config]=\"currConfig\"\n      [exterior]=\"glnFrameExteriorInput.exterior\"\n      [isDisabled]=\"disabled\"\n      [isError]=\"!!formControl.errors || error\"\n      [isFilled]=\"isFilled\"\n      [isLabelShrink]=\"labelShrink || currConfig?.isLabelShrink\"\n      [isNoAnimation]=\"noAnimation || currConfig?.isNoAnimation || isWriteValueInit\"\n      [isNoLabel]=\"noLabel || currConfig?.isNoLabel\"\n      [isRequired]=\"required\"\n      [label]=\"label\"\n      [glnFrameSize]=\"frameSize || currConfig?.frameSize\"\n      #glnFrameSize=\"glnFrameSize\"\n      [glnFrameSizeElementRef]=\"hostRef\"\n      [glnFrameSizeValue]=\"currConfig?.frameSizeValue || frameSizeDefault\"\n      [glnFrameSizeLabelPd]=\"currConfig?.labelPd\"\n      [glnFrameSizePrepare]=\"glnFrameExteriorInput\"\n      glnFrameOrnament\n      [glnFrameOrnamentLfAlign]=\"ornamLfAlign || currConfig?.ornamLfAlign\"\n      [glnFrameOrnamentRgAlign]=\"ornamRgAlign || currConfig?.ornamRgAlign\"\n      [glnFrameOrnamentPath]=\"'/div{0}'\">\n\n      <span glnfr-orn-lf\n        class=\"gln-ornam-lf\">\n        <ng-content select=\"[gln-orn-lf]\"></ng-content>\n      </span>\n      <span glnfr-orn-rg\n        class=\"gln-ornam-rg\">\n        <ng-content select=\"[gln-orn-rg]\"></ng-content>\n      </span>\n\n      <input #inputElement\n        formControlName=\"textData\"\n        glnfr-pd-ver\n        glnfr-pd-hor\n        glnfr-elem\n        [attr.id]=\"id + '_input'\"\n        [type]=\"typeVal\"\n        [ngClass]=\"['glnin-input', (readOnly ? 'gln-readonly' : '')]\"\n        [attr.disabled]=\"disabled ? '': null\"\n        [attr.autocomplete]=\"!!autoComplete ? autoComplete : null\"\n        [attr.readonly]=\"readOnly ? '': null\"\n        [attr.min]=\"min\"\n        [attr.max]=\"max\"\n        [attr.step]=\"step\"\n        [attr.tabindex]=\"!disabled ? tabIndex : null\"\n        [pattern]=\"pattern\"\n        (focus)=\"doFocus()\"\n        (blur)=\"doBlur()\"\n        (input)=\"doInput($event)\" />\n\n    </gln-frame>\n  </div>\n</ng-container>\n<gln-hint-or-error *ngIf=\"!!helperText\"\n  [text]=\"helperText\"\n  [isError]=\"!!formControl.errors || error\"\n  [isFocused]=\"isFocused\"\n  [isDisabled]=\"disabled\">\n</gln-hint-or-error>", styles: ["gln-input{display:inline-flex;flex-direction:column}gln-input[wdFull]{width:100%}gln-input[wdFull] gln-frame>div>[glnfr-elem]{width:100%}gln-input[noHeEllipsis] gln-hint-or-error{white-space:normal;overflow:visible;text-overflow:clip}gln-input .glnin-input{font-size:inherit;font-family:inherit;letter-spacing:inherit;color:inherit;border:0;box-sizing:content-box;background:none;margin:0;padding:0}gln-input .glnin-input:focus{outline:0}gln-input gln-hint-or-error{padding-left:var(--glnin-he-pd-lf, var(--glnfrs-pd-lf));padding-right:var(--glnin-he-pd-rg, var(--glnfrs-pd-rg))}\n"] }]
        }], ctorParameters: function () { return [{ type: Object, decorators: [{
                    type: Inject,
                    args: [PLATFORM_ID]
                }] }, { type: i0.ChangeDetectorRef }, { type: undefined, decorators: [{
                    type: Optional
                }, {
                    type: Inject,
                    args: [GLN_INPUT_CONFIG]
                }] }, { type: i0.ElementRef }, { type: i0.Renderer2 }, { type: i0.NgZone }]; }, propDecorators: { autoComplete: [{
                type: Input
            }], config: [{
                type: Input
            }], exterior: [{
                type: Input
            }], frameSize: [{
                type: Input
            }], helperText: [{
                type: Input
            }], label: [{
                type: Input
            }], max: [{
                type: Input
            }], maxLength: [{
                type: Input
            }], min: [{
                type: Input
            }], minLength: [{
                type: Input
            }], ornamLfAlign: [{
                type: Input
            }], ornamRgAlign: [{
                type: Input
            }], pattern: [{
                type: Input
            }], step: [{
                type: Input
            }], tabIndex: [{
                type: Input
            }], type: [{
                type: Input
            }], wdFull: [{
                type: Input
            }], focused: [{
                type: Output
            }], blured: [{
                type: Output
            }], inputElementRef: [{
                type: ViewChild,
                args: ['inputElement']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xuLWlucHV0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2dlbGVuaXVtLXVpL3NyYy9saWIvZ2xuLWlucHV0L2dsbi1pbnB1dC5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9nZWxlbml1bS11aS9zcmMvbGliL2dsbi1pbnB1dC9nbG4taW5wdXQuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDcEQsT0FBTyxFQUVMLHVCQUF1QixFQUV2QixTQUFTLEVBRVQsWUFBWSxFQUNaLFVBQVUsRUFDVixNQUFNLEVBQ04sY0FBYyxFQUNkLEtBQUssRUFJTCxRQUFRLEVBQ1IsTUFBTSxFQUNOLFdBQVcsRUFHWCxTQUFTLEVBQ1QsaUJBQWlCLEdBQ2xCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFJTCxXQUFXLEVBQ1gsU0FBUyxFQUNULGFBQWEsRUFDYixpQkFBaUIsRUFJakIsVUFBVSxHQUNYLE1BQU0sZ0JBQWdCLENBQUM7QUFFeEIsT0FBTyxFQUE0QiwyQkFBMkIsRUFBRSxNQUFNLCtEQUErRCxDQUFDO0FBQ3RJLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUVsRSxPQUFPLEVBQUUsWUFBWSxFQUFFLGdCQUFnQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7QUFDdkYsT0FBTyxFQUFFLFlBQVksRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQ2xGLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQzs7Ozs7Ozs7O0FBRXhELElBQUksZUFBZSxHQUFHLENBQUMsQ0FBQztBQUV4QixNQUFNLENBQUMsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLGNBQWMsQ0FBaUIsa0JBQWtCLENBQUMsQ0FBQztBQWV2RixNQUFN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RSxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsV0FBVyxtQkFBbUIsRUFBRTtxQkFDekU7MERBd0YwQyxNQUFNOzBCQUE5QyxNQUFNOzJCQUFDLFdBQVc7OzBCQUVsQixRQUFROzswQkFBSSxNQUFNOzJCQUFDLGdCQUFnQjtrSEFqRi9CLFlBQVk7c0JBRGxCLEtBQUs7Z0JBR0MsTUFBTTtzQkFEWixLQUFLO2dCQUdDLFFBQVE7c0JBRGQsS0FBSztnQkFHQyxTQUFTO3NCQURmLEtBQUs7Z0JBR0MsVUFBVTtzQkFEaEIsS0FBSztnQkFtQkMsS0FBSztzQkFEWCxLQUFLO2dCQUdDLEdBQUc7c0JBRFQsS0FBSztnQkFHQyxTQUFTO3NCQURmLEtBQUs7Z0JBR0MsR0FBRztzQkFEVCxLQUFLO2dCQUdDLFNBQVM7c0JBRGYsS0FBSztnQkFHQyxZQUFZO3NCQURsQixLQUFLO2dCQUdDLFlBQVk7c0JBRGxCLEtBQUs7Z0JBR0MsT0FBTztzQkFEYixLQUFLO2dCQUdDLElBQUk7c0JBRFYsS0FBSztnQkFHQyxRQUFRO3NCQURkLEtBQUs7Z0JBR0MsSUFBSTtzQkFEVixLQUFLO2dCQUdDLE1BQU07c0JBRFosS0FBSztnQkFJRyxPQUFPO3NCQURmLE1BQU07Z0JBR0UsTUFBTTtzQkFEZCxNQUFNO2dCQU1BLGVBQWU7c0JBRHJCLFNBQVM7dUJBQUMsY0FBYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7XG4gIEFmdGVyQ29udGVudEluaXQsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIGZvcndhcmRSZWYsXG4gIEluamVjdCxcbiAgSW5qZWN0aW9uVG9rZW4sXG4gIElucHV0LFxuICBOZ1pvbmUsXG4gIE9uQ2hhbmdlcyxcbiAgT25Jbml0LFxuICBPcHRpb25hbCxcbiAgT3V0cHV0LFxuICBQTEFURk9STV9JRCxcbiAgUmVuZGVyZXIyLFxuICBTaW1wbGVDaGFuZ2VzLFxuICBWaWV3Q2hpbGQsXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEFic3RyYWN0Q29udHJvbCxcbiAgQXN5bmNWYWxpZGF0b3JGbixcbiAgQ29udHJvbFZhbHVlQWNjZXNzb3IsXG4gIEZvcm1Db250cm9sLFxuICBGb3JtR3JvdXAsXG4gIE5HX1ZBTElEQVRPUlMsXG4gIE5HX1ZBTFVFX0FDQ0VTU09SLFxuICBWYWxpZGF0aW9uRXJyb3JzLFxuICBWYWxpZGF0b3IsXG4gIFZhbGlkYXRvckZuLFxuICBWYWxpZGF0b3JzLFxufSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbmltcG9ydCB7IEdsbk5vZGVJbnRlcm5hbFZhbGlkYXRvciwgR0xOX05PREVfSU5URVJOQUxfVkFMSURBVE9SIH0gZnJvbSAnLi4vZGlyZWN0aXZlcy9nbG4tcmVnZXgvZ2xuLW5vZGUtaW50ZXJuYWwtdmFsaWRhdG9yLmludGVyZmFjZSc7XG5pbXBvcnQgeyBHbG5CYXNpc0ZyYW1lIH0gZnJvbSAnLi4vX2NsYXNzZXMvZ2xuLWJhc2lzLWZyYW1lLmNsYXNzJztcbmltcG9ydCB7IEdsbkZyYW1lQ29uZmlnIH0gZnJvbSAnLi4vZ2xuLWZyYW1lL2dsbi1mcmFtZS1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IEdsbkZyYW1lU2l6ZSwgR2xuRnJhbWVTaXplVXRpbCB9IGZyb20gJy4uL2dsbi1mcmFtZS9nbG4tZnJhbWUtc2l6ZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgR2xuSW5wdXRUeXBlLCBHbG5JbnB1dFR5cGVVdGlsIH0gZnJvbSAnLi4vZ2xuLWlucHV0L2dsbi1pbnB1dC5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgSHRtbEVsZW1VdGlsIH0gZnJvbSAnLi4vX3V0aWxzL2h0bWwtZWxlbS51dGlsJztcblxubGV0IHVuaXF1ZUlkQ291bnRlciA9IDA7XG5cbmV4cG9ydCBjb25zdCBHTE5fSU5QVVRfQ09ORklHID0gbmV3IEluamVjdGlvblRva2VuPEdsbkZyYW1lQ29uZmlnPignR0xOX0lOUFVUX0NPTkZJRycpO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdnbG4taW5wdXQnLFxuICBleHBvcnRBczogJ2dsbklucHV0JyxcbiAgdGVtcGxhdGVVcmw6ICcuL2dsbi1pbnB1dC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2dsbi1pbnB1dC5jb21wb25lbnQuc2NzcyddLFxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgcHJvdmlkZXJzOiBbXG4gICAgeyBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUiwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gR2xuSW5wdXRDb21wb25lbnQpLCBtdWx0aTogdHJ1ZSB9LFxuICAgIHsgcHJvdmlkZTogTkdfVkFMSURBVE9SUywgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gR2xuSW5wdXRDb21wb25lbnQpLCBtdWx0aTogdHJ1ZSB9LFxuICAgIHsgcHJvdmlkZTogR0xOX05PREVfSU5URVJOQUxfVkFMSURBVE9SLCB1c2VFeGlzdGluZzogR2xuSW5wdXRDb21wb25lbnQgfSxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgR2xuSW5wdXRDb21wb25lbnRcbiAgZXh0ZW5kcyBHbG5CYXNpc0ZyYW1lXG4gIGltcGxlbWVudHMgT25DaGFuZ2VzLCBPbkluaXQsIEFmdGVyQ29udGVudEluaXQsIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBWYWxpZGF0b3IsIEdsbk5vZGVJbnRlcm5hbFZhbGlkYXRvclxue1xuICAvLyBASW5wdXQoKVxuICAvLyBwdWJsaWMgaWQgPSBgZ2xuaW4tJHt1bmlxdWVJZENvdW50ZXIrK31gOyAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBhdXRvQ29tcGxldGUgPSAnJztcbiAgQElucHV0KClcbiAgcHVibGljIGNvbmZpZzogR2xuRnJhbWVDb25maWcgfCBudWxsIHwgdW5kZWZpbmVkO1xuICBASW5wdXQoKVxuICBwdWJsaWMgZXh0ZXJpb3I6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7IC8vIEdsbkZyYW1lRXh0ZXJpb3JUeXBlXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBmcmFtZVNpemU6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7IC8vIEdsbkZyYW1lU2l6ZVR5cGVcbiAgQElucHV0KClcbiAgcHVibGljIGhlbHBlclRleHQ6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIC8vIEBJbnB1dCgpXG4gIC8vIHB1YmxpYyBpc0Rpc2FibGVkOiBzdHJpbmcgfCBib29sZWFuIHwgbnVsbCB8IHVuZGVmaW5lZDsgLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBASW5wdXQoKVxuICAvLyBwdWJsaWMgaXNFcnJvcjogc3RyaW5nIHwgYm9vbGVhbiB8IG51bGwgfCB1bmRlZmluZWQ7IC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgLy8gQElucHV0KClcbiAgLy8gcHVibGljIGlzTGFiZWxTaHJpbms6IHN0cmluZyB8IGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkOyAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIEBJbnB1dCgpXG4gIC8vIHB1YmxpYyBpc05vQW5pbWF0aW9uOiBzdHJpbmcgfCBib29sZWFuIHwgbnVsbCB8IHVuZGVmaW5lZDsgLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBASW5wdXQoKVxuICAvLyBwdWJsaWMgaXNOb0xhYmVsOiBzdHJpbmcgfCBib29sZWFuIHwgbnVsbCB8IHVuZGVmaW5lZDsgLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBASW5wdXQoKVxuICAvLyBwdWJsaWMgaXNSZWFkT25seTogc3RyaW5nIHwgYm9vbGVhbiB8IG51bGwgfCB1bmRlZmluZWQ7IC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgLy8gQElucHV0KClcbiAgLy8gcHVibGljIGlzUmVxdWlyZWQ6IHN0cmluZyB8IGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkOyAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIEBJbnB1dCgpXG4gIC8vIHB1YmxpYyBpc1ZhbHVlSW5pdDogc3RyaW5nIHwgYm9vbGVhbiB8IG51bGwgfCB1bmRlZmluZWQ7IC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgQElucHV0KClcbiAgcHVibGljIGxhYmVsOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkO1xuICBASW5wdXQoKVxuICBwdWJsaWMgbWF4OiBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkO1xuICBASW5wdXQoKVxuICBwdWJsaWMgbWF4TGVuZ3RoOiBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkO1xuICBASW5wdXQoKVxuICBwdWJsaWMgbWluOiBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkO1xuICBASW5wdXQoKVxuICBwdWJsaWMgbWluTGVuZ3RoOiBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkO1xuICBASW5wdXQoKVxuICBwdWJsaWMgb3JuYW1MZkFsaWduOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkOyAvLyBPcm5hbUFsaWduXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBvcm5hbVJnQWxpZ246IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7IC8vIE9ybmFtQWxpZ25cbiAgQElucHV0KClcbiAgcHVibGljIHBhdHRlcm46IHN0cmluZyB8IFJlZ0V4cCA9ICcnO1xuICBASW5wdXQoKVxuICBwdWJsaWMgc3RlcDogbnVtYmVyIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgQElucHV0KClcbiAgcHVibGljIHRhYkluZGV4ID0gMDtcbiAgQElucHV0KClcbiAgcHVibGljIHR5cGU6IHN0cmluZyA9IEdsbklucHV0VHlwZS50ZXh0LnZhbHVlT2YoKTtcbiAgQElucHV0KClcbiAgcHVibGljIHdkRnVsbDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcblxuICBAT3V0cHV0KClcbiAgcmVhZG9ubHkgZm9jdXNlZDogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KClcbiAgcmVhZG9ubHkgYmx1cmVkOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIC8vIEBPdXRwdXQoKVxuICAvLyByZWFkb25seSB3cml0ZVZhbHVlSW5pdDogRXZlbnRFbWl0dGVyPCgpID0+IHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcigpOyAvLyBGcm9tIEdsbkJhc2lzQnlGcmFtZVxuXG4gIEBWaWV3Q2hpbGQoJ2lucHV0RWxlbWVudCcpXG4gIHB1YmxpYyBpbnB1dEVsZW1lbnRSZWY6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+IHwgbnVsbCA9IG51bGw7XG5cbiAgcHVibGljIGN1cnJDb25maWc6IEdsbkZyYW1lQ29uZmlnIHwgbnVsbCA9IG51bGw7XG4gIC8vIHB1YmxpYyBkaXNhYmxlZDogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAvLyBCaW5kaW5nIGF0dHJpYnV0ZSBcImlzRGlzYWJsZWRcIi4gLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBwdWJsaWMgZXJyb3I6IGJvb2xlYW4gfCBudWxsID0gbnVsbDsgLy8gQmluZGluZyBhdHRyaWJ1dGUgXCJpc0Vycm9yXCIuIC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgcHVibGljIGZvcm1Db250cm9sOiBGb3JtQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCh7IHZhbHVlOiBudWxsLCBkaXNhYmxlZDogZmFsc2UgfSwgW10pO1xuICBwdWJsaWMgZm9ybUdyb3VwOiBGb3JtR3JvdXAgPSBuZXcgRm9ybUdyb3VwKHsgdGV4dERhdGE6IHRoaXMuZm9ybUNvbnRyb2wgfSk7XG4gIHB1YmxpYyBmcmFtZVNpemVEZWZhdWx0ID0gR2xuRnJhbWVTaXplVXRpbC5nZXRWYWx1ZShHbG5GcmFtZVNpemUubWlkZGxlKSB8fCAwO1xuICBwdWJsaWMgaXNGb2N1c2VkID0gZmFsc2U7XG4gIHB1YmxpYyBpc0ZpbGxlZCA9IGZhbHNlO1xuICAvLyBwdWJsaWMgaXNXcml0ZVZhbHVlSW5pdDogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIC8vIHB1YmxpYyBsYWJlbFNocmluazogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAvLyBCaW5kaW5nIGF0dHJpYnV0ZSBcImlzTGFiZWxTaHJpbmtcIi4gLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBwdWJsaWMgbm9BbmltYXRpb246IGJvb2xlYW4gfCBudWxsID0gbnVsbDsgLy8gQmluZGluZyBhdHRyaWJ1dGUgXCJpc05vQW5pbWF0aW9uXCIuIC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgLy8gcHVibGljIG5vTGFiZWw6IGJvb2xlYW4gfCBudWxsID0gbnVsbDsgLy8gQmluZGluZyBhdHRyaWJ1dGUgXCJpc05vTGFiZWxcIi4gLy8gSXMgaW4gR2xuQmFzaXNDb250cm9sLlxuICAvLyBwdWJsaWMgcmVhZE9ubHk6IGJvb2xlYW4gfCBudWxsID0gbnVsbDsgLy8gQmluZGluZyBhdHRyaWJ1dGUgXCJpc1JlYWRPbmx5XCIuIC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cbiAgLy8gcHVibGljIHJlcXVpcmVkOiBib29sZWFuIHwgbnVsbCA9IG51bGw7IC8vIEJpbmRpbmcgYXR0cmlidXRlIFwiaXNSZXF1aXJlZFwiLiAvLyBJcyBpbiBHbG5CYXNpc0NvbnRyb2wuXG4gIHB1YmxpYyB0eXBlVmFsOiBHbG5JbnB1dFR5cGUgPSBHbG5JbnB1dFR5cGUudGV4dDtcbiAgLy8gcHVibGljIHZhbHVlSW5pdDogYm9vbGVhbiB8IG51bGwgPSBudWxsOyAvLyBCaW5kaW5nIGF0dHJpYnV0ZSBcImlzVmFsdWVJbml0XCIuIC8vIElzIGluIEdsbkJhc2lzQ29udHJvbC5cblxuICBjb25zdHJ1Y3RvcihcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xuICAgIEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZDogT2JqZWN0LFxuICAgIGNoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBAT3B0aW9uYWwoKSBASW5qZWN0KEdMTl9JTlBVVF9DT05GSUcpIHByaXZhdGUgcm9vdENvbmZpZzogR2xuRnJhbWVDb25maWcgfCBudWxsLFxuICAgIGhvc3RSZWY6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+LFxuICAgIHJlbmRlcmVyOiBSZW5kZXJlcjIsXG4gICAgbmdab25lOiBOZ1pvbmVcbiAgKSB7XG4gICAgc3VwZXIodW5pcXVlSWRDb3VudGVyKyssICdnbG5pbicsIGhvc3RSZWYsIHJlbmRlcmVyLCBjaGFuZ2VEZXRlY3RvclJlZiwgbmdab25lKTtcbiAgICB0aGlzLmN1cnJDb25maWcgPSB0aGlzLnJvb3RDb25maWc7XG4gICAgSHRtbEVsZW1VdGlsLnNldENsYXNzKHRoaXMucmVuZGVyZXIsIHRoaXMuaG9zdFJlZiwgJ2dsbi1pbnB1dCcsIHRydWUpO1xuICAgIEh0bWxFbGVtVXRpbC5zZXRDbGFzcyh0aGlzLnJlbmRlcmVyLCB0aGlzLmhvc3RSZWYsICdnbG4tY29udHJvbCcsIHRydWUpO1xuICB9XG5cbiAgcHVibGljIG92ZXJyaWRlIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICAvLyBJbiB0aGUgR2xuQmFzaXNDb250cm9sLm5nT25DaGFuZ2VzKCksIHRoZSBkZWZpbml0aW9uIGlzIG1hZGU6XG4gICAgLy8gLSB0aGlzLmRpc2FibGVkID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzRGlzYWJsZWQpO1xuICAgIC8vIC0gdGhpcy5lcnJvciA9IEJvb2xlYW5VdGlsLmluaXQodGhpcy5pc0Vycm9yKTtcbiAgICAvLyAtIHRoaXMubGFiZWxTaHJpbmsgPSBCb29sZWFuVXRpbC5pbml0KHRoaXMuaXNMYWJlbFNocmluayk7XG4gICAgLy8gLSB0aGlzLm5vQW5pbWF0aW9uID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzTm9BbmltYXRpb24pO1xuICAgIC8vIC0gdGhpcy5ub0xhYmVsID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzTm9MYWJlbCk7XG4gICAgLy8gLSB0aGlzLnJlYWRPbmx5ID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzUmVhZE9ubHkpO1xuICAgIC8vIC0gdGhpcy5yZXF1aXJlZCA9IEJvb2xlYW5VdGlsLmluaXQodGhpcy5pc1JlcXVpcmVkKTtcbiAgICAvLyAtIHRoaXMudmFsdWVJbml0ID0gQm9vbGVhblV0aWwuaW5pdCh0aGlzLmlzVmFsdWVJbml0KTtcbiAgICBzdXBlci5uZ09uQ2hhbmdlcyhjaGFuZ2VzKTtcbiAgICBpZiAoY2hhbmdlc1sndHlwZSddKSB7XG4gICAgICB0aGlzLnR5cGVWYWwgPSBHbG5JbnB1dFR5cGVVdGlsLmNyZWF0ZSh0aGlzLnR5cGUpIHx8IEdsbklucHV0VHlwZS50ZXh0O1xuICAgIH1cbiAgICBpZiAoY2hhbmdlc1snY29uZmlnJ10pIHtcbiAgICAgIHRoaXMuY3VyckNvbmZpZyA9IHsgLi4udGhpcy5yb290Q29uZmlnLCAuLi50aGlzLmNvbmZpZyB9O1xuICAgIH1cbiAgICBpZiAoY2hhbmdlc1snaXNSZXF1aXJlZCddIHx8IGNoYW5nZXNbJ21pbkxlbmd0aCddIHx8IGNoYW5nZXNbJ21heExlbmd0aCddKSB7XG4gICAgICB0aGlzLnByZXBhcmVGb3JtR3JvdXAodGhpcy5yZXF1aXJlZCwgdGhpcy5taW5MZW5ndGgsIHRoaXMubWF4TGVuZ3RoKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgb3ZlcnJpZGUgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgc3VwZXIubmdPbkluaXQoKTtcbiAgfVxuXG4gIHB1YmxpYyBvdmVycmlkZSBuZ0FmdGVyQ29udGVudEluaXQoKTogdm9pZCB7XG4gICAgc3VwZXIubmdBZnRlckNvbnRlbnRJbml0KCk7XG4gIH1cblxuICAvLyAqKiBDb250cm9sVmFsdWVBY2Nlc3NvciAtIHN0YXJ0ICoqXG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgcHVibGljIG92ZXJyaWRlIHdyaXRlVmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xuICAgIGNvbnN0IGlzRmlsbGVkT2xkID0gISF0aGlzLmZvcm1Db250cm9sLnZhbHVlO1xuICAgIHRoaXMuZm9ybUNvbnRyb2wuc2V0VmFsdWUodmFsdWUsIHsgZW1pdEV2ZW50OiBmYWxzZSB9KTtcbiAgICB0aGlzLmlzRmlsbGVkID0gdGhpcy5mb3JtQ29udHJvbC52YWx1ZSAhPT0gJycgJiYgdGhpcy5mb3JtQ29udHJvbC52YWx1ZSAhPSBudWxsO1xuICAgIGlmIChpc0ZpbGxlZE9sZCAhPT0gdGhpcy5pc0ZpbGxlZCkge1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gICAgc3VwZXIud3JpdGVWYWx1ZSh2YWx1ZSk7XG4gIH1cblxuICBwdWJsaWMgb3ZlcnJpZGUgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZGlzYWJsZWQgIT09IGlzRGlzYWJsZWQpIHtcbiAgICAgIGlzRGlzYWJsZWQgPyB0aGlzLmZvcm1Hcm91cC5kaXNhYmxlKCkgOiB0aGlzLmZvcm1Hcm91cC5lbmFibGUoKTtcbiAgICAgIHN1cGVyLnNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZCk7XG4gICAgfVxuICB9XG5cbiAgLy8gKiogQ29udHJvbFZhbHVlQWNjZXNzb3IgLSBmaW5pc2ggKipcblxuICAvLyAqKiBWYWxpZGF0b3IgLSBzdGFydCAqKlxuXG4gIHB1YmxpYyB2YWxpZGF0ZShjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCB7XG4gICAgcmV0dXJuICFjb250cm9sID8gbnVsbCA6IHRoaXMuZm9ybUNvbnRyb2wuZXJyb3JzO1xuICB9XG5cbiAgLy8gKiogVmFsaWRhdG9yIC0gZmluaXNoICoqXG5cbiAgLy8gKiogR2xuTm9kZUludGVybmFsVmFsaWRhdG9yIC0gc3RhcnQgKipcblxuICBwdWJsaWMgYWRkVmFsaWRhdG9ycyh2YWxpZGF0b3JzOiBWYWxpZGF0b3JGbiB8IFZhbGlkYXRvckZuW10pOiB2b2lkIHtcbiAgICBpZiAodmFsaWRhdG9ycyAhPSBudWxsKSB7XG4gICAgICB0aGlzLmZvcm1Db250cm9sLmFkZFZhbGlkYXRvcnModmFsaWRhdG9ycyk7XG4gICAgICB0aGlzLmZvcm1Db250cm9sLnVwZGF0ZVZhbHVlQW5kVmFsaWRpdHkoKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgYWRkQXN5bmNWYWxpZGF0b3JzKHZhbGlkYXRvcnM6IEFzeW5jVmFsaWRhdG9yRm4gfCBBc3luY1ZhbGlkYXRvckZuW10pOiB2b2lkIHtcbiAgICBpZiAodmFsaWRhdG9ycyAhPSBudWxsKSB7XG4gICAgICB0aGlzLmZvcm1Db250cm9sLmFkZEFzeW5jVmFsaWRhdG9ycyh2YWxpZGF0b3JzKTtcbiAgICAgIHRoaXMuZm9ybUNvbnRyb2wudXBkYXRlVmFsdWVBbmRWYWxpZGl0eSgpO1xuICAgIH1cbiAgfVxuXG4gIC8vICoqIEdsbk5vZGVJbnRlcm5hbFZhbGlkYXRvciAtIGZpbmlzaCAqKlxuXG4gIC8vICoqIFB1YmxpYyBBUEkgKipcblxuICBwdWJsaWMgZm9jdXMoKTogdm9pZCB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkgJiYgISF0aGlzLmlucHV0RWxlbWVudFJlZikge1xuICAgICAgdGhpcy5pbnB1dEVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBkb0ZvY3VzKCk6IHZvaWQge1xuICAgIHRoaXMuaXNGb2N1c2VkID0gdHJ1ZTtcbiAgICB0aGlzLmZvY3VzU3RhdGUodGhpcy5yZW5kZXJlciwgdGhpcy5ob3N0UmVmLCB0aGlzLmlzRm9jdXNlZCk7XG4gICAgdGhpcy5mb2N1c2VkLmVtaXQoKTtcbiAgfVxuXG4gIHB1YmxpYyBkb0JsdXIoKTogdm9pZCB7XG4gICAgdGhpcy5pc0ZvY3VzZWQgPSBmYWxzZTtcbiAgICB0aGlzLmZvY3VzU3RhdGUodGhpcy5yZW5kZXJlciwgdGhpcy5ob3N0UmVmLCB0aGlzLmlzRm9jdXNlZCk7XG4gICAgdGhpcy5pc0ZpbGxlZCA9ICEhdGhpcy5mb3JtQ29udHJvbC52YWx1ZTtcbiAgICB0aGlzLm9uVG91Y2hlZCgpO1xuICAgIHRoaXMuYmx1cmVkLmVtaXQoKTtcbiAgfVxuXG4gIHB1YmxpYyBkb0lucHV0KGV2ZW50OiBFdmVudCk6IHZvaWQge1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIvaXNzdWVzLzk1ODcgXCJldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSBjYWxsZWQgZnJvbSBsaXN0ZW5lcnMgbm90IHdvcmtpbmdcIlxuICAgIC8vIEFkZGVkIEV2ZW50LmNhbmNlbEJ1YmJsZSBjaGVjayB0byBtYWtlIHN1cmUgdGhlcmUgd2FzIG5vIGNhbGwgdG8gZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkgaW4gcHJldmlvdXMgaGFuZGxlcnMuXG4gICAgaWYgKCEhZXZlbnQgJiYgIWV2ZW50LmNhbmNlbEJ1YmJsZSkge1xuICAgICAgdGhpcy5vbkNoYW5nZSh0aGlzLmZvcm1Db250cm9sLnZhbHVlKTtcbiAgICB9XG4gIH1cblxuICAvLyAqKiBQcml2YXRlIEFQSSAqKlxuXG4gIHByaXZhdGUgcHJlcGFyZUZvcm1Hcm91cChpc1JlcXVpcmVkOiBib29sZWFuIHwgbnVsbCwgbWluTGVuZ3RoOiBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkLCBtYXhMZW5ndGg6IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQpOiB2b2lkIHtcbiAgICB0aGlzLmZvcm1Db250cm9sLmNsZWFyVmFsaWRhdG9ycygpO1xuICAgIGNvbnN0IG5ld1ZhbGlkYXRvcjogVmFsaWRhdG9yRm5bXSA9IFtdO1xuICAgIGlmIChpc1JlcXVpcmVkKSB7XG4gICAgICBuZXdWYWxpZGF0b3IucHVzaChWYWxpZGF0b3JzLnJlcXVpcmVkKTtcbiAgICB9XG4gICAgaWYgKCEhbWluTGVuZ3RoICYmIG1pbkxlbmd0aCA+IDApIHtcbiAgICAgIG5ld1ZhbGlkYXRvci5wdXNoKFZhbGlkYXRvcnMubWluTGVuZ3RoKG1pbkxlbmd0aCkpO1xuICAgIH1cbiAgICBpZiAoISFtYXhMZW5ndGggJiYgbWF4TGVuZ3RoID4gMCkge1xuICAgICAgbmV3VmFsaWRhdG9yLnB1c2goVmFsaWRhdG9ycy5tYXhMZW5ndGgobWF4TGVuZ3RoKSk7XG4gICAgfVxuICAgIHRoaXMuZm9ybUNvbnRyb2wuc2V0VmFsaWRhdG9ycyhuZXdWYWxpZGF0b3IpO1xuICB9XG5cbiAgcHJpdmF0ZSBmb2N1c1N0YXRlKHJlbmRlcmVyOiBSZW5kZXJlcjIsIGVsZW06IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+LCB2YWx1ZTogYm9vbGVhbik6IHZvaWQge1xuICAgIEh0bWxFbGVtVXRpbC5zZXRDbGFzcyhyZW5kZXJlciwgZWxlbSwgJ2dsbi1mb2N1c2VkJywgdmFsdWUgfHwgZmFsc2UpO1xuICAgIEh0bWxFbGVtVXRpbC5zZXRBdHRyKHJlbmRlcmVyLCBlbGVtLCAnZm9jJywgdmFsdWUgPyAnJyA6IG51bGwpO1xuICB9XG59XG4iLCI8bmctY29udGFpbmVyIFtmb3JtR3JvdXBdPVwiZm9ybUdyb3VwXCI+XG4gIDxkaXYgY2xhc3M9XCJnbG5pbi13cmFwXCJcbiAgICBbZ2xuRnJhbWVFeHRlcmlvcklucHV0XT1cImV4dGVyaW9yIHx8IGN1cnJDb25maWc/LmV4dGVyaW9yXCJcbiAgICAjZ2xuRnJhbWVFeHRlcmlvcklucHV0PVwiZ2xuRnJhbWVFeHRlcmlvcklucHV0XCJcbiAgICBbZ2xuRnJhbWVFeHRlcmlvcklucHV0RWxlbWVudFJlZl09XCJob3N0UmVmXCJcbiAgICAoZ2xuRnJhbWVFeHRlcmlvcklucHV0Q2hhbmdlKT1cImdsbkZyYW1lU2l6ZS51cGRhdGVQYWRkaW5nVmVyQW5kSG9yKClcIj5cbiAgICA8Z2xuLWZyYW1lIFtjb25maWddPVwiY3VyckNvbmZpZ1wiXG4gICAgICBbZXh0ZXJpb3JdPVwiZ2xuRnJhbWVFeHRlcmlvcklucHV0LmV4dGVyaW9yXCJcbiAgICAgIFtpc0Rpc2FibGVkXT1cImRpc2FibGVkXCJcbiAgICAgIFtpc0Vycm9yXT1cIiEhZm9ybUNvbnRyb2wuZXJyb3JzIHx8IGVycm9yXCJcbiAgICAgIFtpc0ZpbGxlZF09XCJpc0ZpbGxlZFwiXG4gICAgICBbaXNMYWJlbFNocmlua109XCJsYWJlbFNocmluayB8fCBjdXJyQ29uZmlnPy5pc0xhYmVsU2hyaW5rXCJcbiAgICAgIFtpc05vQW5pbWF0aW9uXT1cIm5vQW5pbWF0aW9uIHx8IGN1cnJDb25maWc/LmlzTm9BbmltYXRpb24gfHwgaXNXcml0ZVZhbHVlSW5pdFwiXG4gICAgICBbaXNOb0xhYmVsXT1cIm5vTGFiZWwgfHwgY3VyckNvbmZpZz8uaXNOb0xhYmVsXCJcbiAgICAgIFtpc1JlcXVpcmVkXT1cInJlcXVpcmVkXCJcbiAgICAgIFtsYWJlbF09XCJsYWJlbFwiXG4gICAgICBbZ2xuRnJhbWVTaXplXT1cImZyYW1lU2l6ZSB8fCBjdXJyQ29uZmlnPy5mcmFtZVNpemVcIlxuICAgICAgI2dsbkZyYW1lU2l6ZT1cImdsbkZyYW1lU2l6ZVwiXG4gICAgICBbZ2xuRnJhbWVTaXplRWxlbWVudFJlZl09XCJob3N0UmVmXCJcbiAgICAgIFtnbG5GcmFtZVNpemVWYWx1ZV09XCJjdXJyQ29uZmlnPy5mcmFtZVNpemVWYWx1ZSB8fCBmcmFtZVNpemVEZWZhdWx0XCJcbiAgICAgIFtnbG5GcmFtZVNpemVMYWJlbFBkXT1cImN1cnJDb25maWc/LmxhYmVsUGRcIlxuICAgICAgW2dsbkZyYW1lU2l6ZVByZXBhcmVdPVwiZ2xuRnJhbWVFeHRlcmlvcklucHV0XCJcbiAgICAgIGdsbkZyYW1lT3JuYW1lbnRcbiAgICAgIFtnbG5GcmFtZU9ybmFtZW50TGZBbGlnbl09XCJvcm5hbUxmQWxpZ24gfHwgY3VyckNvbmZpZz8ub3JuYW1MZkFsaWduXCJcbiAgICAgIFtnbG5GcmFtZU9ybmFtZW50UmdBbGlnbl09XCJvcm5hbVJnQWxpZ24gfHwgY3VyckNvbmZpZz8ub3JuYW1SZ0FsaWduXCJcbiAgICAgIFtnbG5GcmFtZU9ybmFtZW50UGF0aF09XCInL2RpdnswfSdcIj5cblxuICAgICAgPHNwYW4gZ2xuZnItb3JuLWxmXG4gICAgICAgIGNsYXNzPVwiZ2xuLW9ybmFtLWxmXCI+XG4gICAgICAgIDxuZy1jb250ZW50IHNlbGVjdD1cIltnbG4tb3JuLWxmXVwiPjwvbmctY29udGVudD5cbiAgICAgIDwvc3Bhbj5cbiAgICAgIDxzcGFuIGdsbmZyLW9ybi1yZ1xuICAgICAgICBjbGFzcz1cImdsbi1vcm5hbS1yZ1wiPlxuICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJbZ2xuLW9ybi1yZ11cIj48L25nLWNvbnRlbnQ+XG4gICAgICA8L3NwYW4+XG5cbiAgICAgIDxpbnB1dCAjaW5wdXRFbGVtZW50XG4gICAgICAgIGZvcm1Db250cm9sTmFtZT1cInRleHREYXRhXCJcbiAgICAgICAgZ2xuZnItcGQtdmVyXG4gICAgICAgIGdsbmZyLXBkLWhvclxuICAgICAgICBnbG5mci1lbGVtXG4gICAgICAgIFthdHRyLmlkXT1cImlkICsgJ19pbnB1dCdcIlxuICAgICAgICBbdHlwZV09XCJ0eXBlVmFsXCJcbiAgICAgICAgW25nQ2xhc3NdPVwiWydnbG5pbi1pbnB1dCcsIChyZWFkT25seSA/ICdnbG4tcmVhZG9ubHknIDogJycpXVwiXG4gICAgICAgIFthdHRyLmRpc2FibGVkXT1cImRpc2FibGVkID8gJyc6IG51bGxcIlxuICAgICAgICBbYXR0ci5hdXRvY29tcGxldGVdPVwiISFhdXRvQ29tcGxldGUgPyBhdXRvQ29tcGxldGUgOiBudWxsXCJcbiAgICAgICAgW2F0dHIucmVhZG9ubHldPVwicmVhZE9ubHkgPyAnJzogbnVsbFwiXG4gICAgICAgIFthdHRyLm1pbl09XCJtaW5cIlxuICAgICAgICBbYXR0ci5tYXhdPVwibWF4XCJcbiAgICAgICAgW2F0dHIuc3RlcF09XCJzdGVwXCJcbiAgICAgICAgW2F0dHIudGFiaW5kZXhdPVwiIWRpc2FibGVkID8gdGFiSW5kZXggOiBudWxsXCJcbiAgICAgICAgW3BhdHRlcm5dPVwicGF0dGVyblwiXG4gICAgICAgIChmb2N1cyk9XCJkb0ZvY3VzKClcIlxuICAgICAgICAoYmx1cik9XCJkb0JsdXIoKVwiXG4gICAgICAgIChpbnB1dCk9XCJkb0lucHV0KCRldmVudClcIiAvPlxuXG4gICAgPC9nbG4tZnJhbWU+XG4gIDwvZGl2PlxuPC9uZy1jb250YWluZXI+XG48Z2xuLWhpbnQtb3ItZXJyb3IgKm5nSWY9XCIhIWhlbHBlclRleHRcIlxuICBbdGV4dF09XCJoZWxwZXJUZXh0XCJcbiAgW2lzRXJyb3JdPVwiISFmb3JtQ29udHJvbC5lcnJvcnMgfHwgZXJyb3JcIlxuICBbaXNGb2N1c2VkXT1cImlzRm9jdXNlZFwiXG4gIFtpc0Rpc2FibGVkXT1cImRpc2FibGVkXCI+XG48L2dsbi1oaW50LW9yLWVycm9yPiJdfQ==