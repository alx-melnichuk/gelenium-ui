<div glnsl-wrap
  class="glnsl-wrap">
  <gln-frame [ngClass]="[(isPanelOpen ? 'is-open' : '')]"
    cdkOverlayOrigin
    #origin="cdkOverlayOrigin"
    #triggerRef
    [config]="currConfig"
    [cssElementRef]="triggerHtmlElementRef"
    [exterior]="exterior || currConfig.exterior"
    [frameSize]="frameSize || currConfig.frameSize"
    [isAttrHideAnimation]="isAttrHideAnimation"
    [isDisabled]="disabled"
    [isError]="!!errors || error"
    [isFilled]="isFilled"
    [isLabelShrink]="getBoolean(isLabelShrink) ?? currConfig.isLabelShrink"
    [isNoAnimation]="getBoolean(isNoAnimation) ?? currConfig.isNoAnimation"
    [isRequired]="required"
    [label]="!placeholder ? label : null"
    glnFrameOrnament
    [glnFrameOrnamentLfAlign]="ornamLfAlignVal"
    [glnFrameOrnamentRgAlign]="ornamRgAlignVal"
    [glnFrameOrnamentPath]="'/div{0}'"
    [attr.opn]="isPanelOpen ? '' : null"
    [attr.tabindex]="!disabled ? tabIndex : null"
    (focus)="doFocus()"
    (blur)="doBlur()"
    (keydown)="frameKeydown($event)"
    (click)="!disabled ? toggle() : null">

    <span glnfr-orn-lf
      class="gln-ornam-lf">
      <ng-content select="[gln-orn-lf]"></ng-content>
    </span>

    <span glnfr-orn-rg
      class="gln-ornam-rg">
      <ng-content select="[gln-orn-rg]"></ng-content>

      <div *ngIf="!getBoolean(isNoIcon) && !currConfig?.isNoIcon"
        glnsl-rhomb
        [attr.opn]="isPanelOpen ? '' : null"
        [attr.noAnm]="noAnimation ? '' : null"
        [ngClass]="['glnsl-rhomb', (isPanelOpen ? 'is-open' : '')]"
        focusable="false"
        aria-hidden="true">
      </div>
    </span>

    <div [attr.id]="id + '-elem'"
      glnfr-pd-ver
      glnfr-pd-hor
      glnfr-elem>

      <ng-container [ngSwitch]="isFilled">
        <div *ngSwitchCase="false"
          glnsl-plc-hld
          class="glnsl-placeholder">
          <span>{{ !placeholder ? '&ZeroWidthSpace;' : label }}</span>
        </div>

        <ng-container *ngSwitchCase="true"
          [ngSwitch]="!!customTrigger">

          <ng-content *ngSwitchCase="true"
            select="gln-select-trigger">
          </ng-content>

          <ng-container *ngSwitchCase="false">
            <ng-container
              *ngFor="let option of selectedOptions; count as countVal; last as isLast; trackBy: trackByOption;">
              <span [innerHTML]="option.getTrustHtml()"></span>
              <span *ngIf="countVal > 1 && !isLast">, </span>
            </ng-container>
          </ng-container>

        </ng-container>
      </ng-container>
    </div>

  </gln-frame>

  <gln-hint-or-error *ngIf="!!helperText"
    [text]="helperText"
    [isError]="!!errors || error"
    [isFocused]="isFocused"
    [isDisabled]="disabled">
  </gln-hint-or-error>

</div>


<ng-template cdkConnectedOverlay
  [cdkConnectedOverlayBackdropClass]="backdropClassVal || 'cdk-overlay-transparent-backdrop'"
  cdkConnectedOverlayHasBackdrop
  [cdkConnectedOverlayDisableClose]="true"
  cdkConnectedOverlayLockPosition
  [cdkConnectedOverlayMinWidth]="triggerRect?.width!"
  [cdkConnectedOverlayOpen]="isPanelOpen || hasPanelAnimation"
  [cdkConnectedOverlayOrigin]="origin"
  [cdkConnectedOverlayPanelClass]="overlayPanelClass"
  [cdkConnectedOverlayPositions]="positionList"
  [cdkConnectedOverlayScrollStrategy]="scrollStrategy"
  (backdropClick)="backdropClick()"
  (attach)="attach()"
  (detach)="detach()"
  (overlayKeydown)="doOverlayPanelKeydown($event)">

  <div glnslp-wrap
    class="gln-select-panel-wrap"
    [ngClass]="[(noAnimation ? 'gln-no-animation' : '')]"
    [attr.noAnm]="noAnimation ? '' : null"
    (animationend)="hasPanelAnimation = isPanelOpen"
    (animationcancel)="hasPanelAnimation = isPanelOpen">
    <div glnsl-panel
      class="gln-select-panel"
      [ngClass]="panelClassValue || ''"
      [glnOptionsScroll]="options"
      (glnOptionsScrollAttached)="optionsScrollAttached($event)"
      role="listbox"
      [attr.id]="id + '-panel'"
      [attr.aria-multiselectable]="multiple"
      (focus)="doFocusOnPanel()">
      <ng-content select=":not(gln-select-trigger)"></ng-content>
    </div>
  </div>

</ng-template>